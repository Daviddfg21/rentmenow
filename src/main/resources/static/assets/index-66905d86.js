import{r as e,a as s,R as a}from"./vendor-3192ac2a.js";import{m as t,B as r,U as i,C as l,A as n,a as o,K as c,P as d,S as m,L as x,X as h,M as p,H as u,b as g,c as y,d as j,e as b,f as N,g as f,h as v,i as w,E as C,j as S,k,l as E,V as P,n as I,o as D,p as A,q as M,r as R,s as O,F as T,G as q,t as L,u as F,v as U,w as $,x as z,y as H,T as B,z as G,I as V,D as J,J as Z,N as _,O as W,Q,R as Y,W as K,Y as X,Z as ee,_ as se,$ as ae,a0 as te}from"./ui-b68c2775.js";import{a as re}from"./utils-25a235f9.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver((e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&s(e)})).observe(document,{childList:!0,subtree:!0})}function s(e){if(e.ep)return;e.ep=!0;const s=function(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerPolicy&&(s.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?s.credentials="include":"anonymous"===e.crossOrigin?s.credentials="omit":s.credentials="same-origin",s}(e);fetch(e.href,s)}}();var ie={exports:{}},le={},ne=e,oe=Symbol.for("react.element"),ce=Symbol.for("react.fragment"),de=Object.prototype.hasOwnProperty,me=ne.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,xe={key:!0,ref:!0,__self:!0,__source:!0};function he(e,s,a){var t,r={},i=null,l=null;for(t in void 0!==a&&(i=""+a),void 0!==s.key&&(i=""+s.key),void 0!==s.ref&&(l=s.ref),s)de.call(s,t)&&!xe.hasOwnProperty(t)&&(r[t]=s[t]);if(e&&e.defaultProps)for(t in s=e.defaultProps)void 0===r[t]&&(r[t]=s[t]);return{$$typeof:oe,type:e,key:i,ref:l,props:r,_owner:me.current}}le.Fragment=ce,le.jsx=he,le.jsxs=he,ie.exports=le;var pe=ie.exports,ue={},ge=s;ue.createRoot=ge.createRoot,ue.hydrateRoot=ge.hydrateRoot;const ye=()=>{const[s,a]=e.useState(null),[g,y]=e.useState(!1),[j,b]=e.useState(!1),[N,f]=e.useState(!1),[v,w]=e.useState(!1),C=e.useRef(null);e.useEffect((()=>{const e=localStorage.getItem("token"),s=localStorage.getItem("user");if(e&&s)try{const e=JSON.parse(s);a(e),y(!0),b("ADMIN"===e.role)}catch(t){localStorage.removeItem("token"),localStorage.removeItem("user")}}),[]),e.useEffect((()=>{const e=e=>{C.current&&!C.current.contains(e.target)&&w(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[]);const S=e=>{window.history.pushState({},"",e),window.dispatchEvent(new PopStateEvent("popstate")),f(!1),w(!1)},k=()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),a(null),y(!1),b(!1),w(!1),f(!1),window.location.href="/"},E=[{name:"Inicio",path:"/",icon:u},{name:"Propiedades",path:"/properties",icon:r},...g?[{name:"Mi Dashboard",path:"/dashboard",icon:o},{name:"Solicitudes",path:"/rentals",icon:c},{name:"Crear Propiedad",path:"/create-property",icon:d},...j?[{name:"Admin",path:"/admin",icon:m}]:[]]:[]];return pe.jsxs("nav",{className:"bg-white/90 backdrop-blur-md shadow-lg border-b border-white/20 sticky top-0 z-50",children:[pe.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:pe.jsxs("div",{className:"flex justify-between h-16",children:[pe.jsx(t.div,{className:"flex items-center",whileHover:{scale:1.05},children:pe.jsxs("button",{onClick:()=>S("/"),className:"flex items-center space-x-2",children:[pe.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-primary-500 to-secondary-500 rounded-lg flex items-center justify-center",children:pe.jsx(r,{className:"w-5 h-5 text-white"})}),pe.jsx("span",{className:"text-xl font-bold bg-gradient-to-r from-primary-600 to-secondary-600 bg-clip-text text-transparent",children:"RentMeNow"})]})}),pe.jsx("div",{className:"hidden md:flex items-center space-x-8",children:E.map((e=>pe.jsx(t.div,{whileHover:{y:-2},children:pe.jsxs("button",{onClick:()=>S(e.path),className:"flex items-center space-x-1 text-gray-700 hover:text-primary-600 transition-colors duration-300",children:[pe.jsx(e.icon,{className:"w-4 h-4"}),pe.jsx("span",{children:e.name})]})},e.path)))}),pe.jsx("div",{className:"hidden md:flex items-center space-x-4",children:g?pe.jsxs("div",{className:"relative",ref:C,children:[pe.jsxs("button",{onClick:()=>{w(!v)},className:"flex items-center space-x-2 text-gray-700 hover:text-primary-600 transition-colors duration-300 p-2 rounded-lg hover:bg-gray-50",children:[pe.jsx("div",{className:"w-8 h-8 bg-primary-100 rounded-full flex items-center justify-center",children:pe.jsx(i,{className:"w-4 h-4 text-primary-600"})}),pe.jsx("span",{className:"text-sm font-medium",children:null==s?void 0:s.username}),pe.jsx(l,{className:"w-4 h-4"})]}),pe.jsx(n,{children:v&&pe.jsxs(t.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute right-0 mt-2 w-64 bg-white rounded-xl shadow-lg border border-gray-200 py-2",children:[pe.jsx("div",{className:"px-4 py-3 border-b border-gray-100",children:pe.jsxs("div",{className:"flex items-center space-x-3",children:[pe.jsx("div",{className:"w-10 h-10 bg-primary-100 rounded-full flex items-center justify-center",children:pe.jsx(i,{className:"w-5 h-5 text-primary-600"})}),pe.jsxs("div",{children:[pe.jsx("p",{className:"text-sm font-medium text-gray-800",children:null==s?void 0:s.username}),pe.jsx("p",{className:"text-xs text-gray-500",children:null==s?void 0:s.email}),pe.jsx("span",{className:"inline-block mt-1 px-2 py-1 bg-primary-100 text-primary-700 text-xs font-medium rounded-full",children:"ADMIN"===(null==s?void 0:s.role)?"Administrador":"Usuario"})]})]})}),pe.jsxs("div",{className:"py-2",children:[pe.jsxs("button",{onClick:()=>S("/dashboard"),className:"flex items-center space-x-3 px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors duration-300 w-full text-left",children:[pe.jsx(o,{className:"w-4 h-4"}),pe.jsx("span",{children:"Mi Dashboard"})]}),pe.jsxs("button",{onClick:()=>S("/profile"),className:"flex items-center space-x-3 px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors duration-300 w-full text-left",children:[pe.jsx(i,{className:"w-4 h-4"}),pe.jsx("span",{children:"Mi Perfil"})]}),pe.jsxs("button",{onClick:()=>S("/rentals"),className:"flex items-center space-x-3 px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors duration-300 w-full text-left",children:[pe.jsx(c,{className:"w-4 h-4"}),pe.jsx("span",{children:"Solicitudes"})]}),pe.jsxs("button",{onClick:()=>S("/create-property"),className:"flex items-center space-x-3 px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors duration-300 w-full text-left",children:[pe.jsx(d,{className:"w-4 h-4"}),pe.jsx("span",{children:"Crear Propiedad"})]}),j&&pe.jsxs("button",{onClick:()=>S("/admin"),className:"flex items-center space-x-3 px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors duration-300 w-full text-left",children:[pe.jsx(m,{className:"w-4 h-4"}),pe.jsx("span",{children:"Panel Admin"})]})]}),pe.jsx("div",{className:"border-t border-gray-100 pt-2",children:pe.jsxs("button",{onClick:k,className:"flex items-center space-x-3 px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors duration-300 w-full text-left",children:[pe.jsx(x,{className:"w-4 h-4"}),pe.jsx("span",{children:"Cerrar Sesión"})]})})]})})]}):pe.jsxs("div",{className:"flex items-center space-x-4",children:[pe.jsx("button",{onClick:()=>S("/login"),className:"text-gray-700 hover:text-primary-600 transition-colors duration-300",children:"Iniciar Sesión"}),pe.jsx("button",{onClick:()=>S("/register"),className:"btn-primary",children:"Registrarse"})]})}),pe.jsx("div",{className:"md:hidden flex items-center",children:pe.jsx("button",{onClick:()=>f(!N),className:"text-gray-700 hover:text-primary-600 transition-colors duration-300",children:N?pe.jsx(h,{className:"w-6 h-6"}):pe.jsx(p,{className:"w-6 h-6"})})})]})}),pe.jsx(n,{children:N&&pe.jsx(t.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"md:hidden bg-white/95 backdrop-blur-md border-t border-gray-200",children:pe.jsxs("div",{className:"px-2 pt-2 pb-3 space-y-1",children:[E.map((e=>pe.jsxs("button",{onClick:()=>S(e.path),className:"flex items-center space-x-2 px-3 py-2 text-gray-700 hover:text-primary-600 hover:bg-primary-50 rounded-lg transition-all duration-300 w-full text-left",children:[pe.jsx(e.icon,{className:"w-4 h-4"}),pe.jsx("span",{children:e.name})]},e.path))),g?pe.jsxs("div",{className:"border-t pt-2 mt-2",children:[pe.jsxs("div",{className:"px-3 py-2 text-sm text-gray-600",children:[null==s?void 0:s.username," - ","ADMIN"===(null==s?void 0:s.role)?"Administrador":"Usuario"]}),pe.jsxs("button",{onClick:()=>S("/profile"),className:"flex items-center space-x-2 px-3 py-2 text-gray-700 hover:bg-primary-50 rounded-lg transition-all duration-300 w-full text-left",children:[pe.jsx(i,{className:"w-4 h-4"}),pe.jsx("span",{children:"Mi Perfil"})]}),pe.jsxs("button",{onClick:k,className:"flex items-center space-x-2 px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-all duration-300 w-full text-left",children:[pe.jsx(x,{className:"w-4 h-4"}),pe.jsx("span",{children:"Cerrar Sesión"})]})]}):pe.jsxs("div",{className:"border-t pt-2 mt-2 space-y-1",children:[pe.jsx("button",{onClick:()=>S("/login"),className:"block px-3 py-2 text-gray-700 hover:bg-primary-50 rounded-lg transition-all duration-300 w-full text-left",children:"Iniciar Sesión"}),pe.jsx("button",{onClick:()=>S("/register"),className:"block px-3 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-all duration-300 w-full text-left",children:"Registrarse"})]})]})})})]})},je=()=>{const e=e=>{window.history.pushState({},"",e),window.dispatchEvent(new PopStateEvent("popstate"))};return pe.jsx("footer",{className:"bg-gray-900 text-white py-16 px-4 mt-20",children:pe.jsxs("div",{className:"max-w-7xl mx-auto",children:[pe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[pe.jsxs("div",{className:"md:col-span-2",children:[pe.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[pe.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-primary-500 to-secondary-500 rounded-lg flex items-center justify-center",children:pe.jsx(r,{className:"w-5 h-5 text-white"})}),pe.jsx("span",{className:"text-xl font-bold",children:"RentMeNow"})]}),pe.jsx("p",{className:"text-gray-400 mb-6 max-w-md",children:"La plataforma líder en alquiler de propiedades. Conectamos propietarios e inquilinos de forma segura y eficiente en toda España."}),pe.jsxs("div",{className:"flex space-x-4",children:[pe.jsx("div",{className:"w-10 h-10 bg-gray-800 rounded-lg flex items-center justify-center hover:bg-primary-600 transition-colors duration-300 cursor-pointer",children:pe.jsx("span",{className:"text-sm font-bold",children:"f"})}),pe.jsx("div",{className:"w-10 h-10 bg-gray-800 rounded-lg flex items-center justify-center hover:bg-primary-600 transition-colors duration-300 cursor-pointer",children:pe.jsx("span",{className:"text-sm font-bold",children:"t"})}),pe.jsx("div",{className:"w-10 h-10 bg-gray-800 rounded-lg flex items-center justify-center hover:bg-primary-600 transition-colors duration-300 cursor-pointer",children:pe.jsx("span",{className:"text-sm font-bold",children:"in"})})]})]}),pe.jsxs("div",{children:[pe.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Enlaces Rápidos"}),pe.jsxs("ul",{className:"space-y-2",children:[pe.jsx("li",{children:pe.jsx("button",{onClick:()=>e("/properties"),className:"text-gray-400 hover:text-white transition-colors duration-300",children:"Propiedades"})}),pe.jsx("li",{children:pe.jsx("button",{onClick:()=>e("/create-property"),className:"text-gray-400 hover:text-white transition-colors duration-300",children:"Publicar Propiedad"})}),pe.jsx("li",{children:pe.jsx("button",{onClick:()=>e("/rentals"),className:"text-gray-400 hover:text-white transition-colors duration-300",children:"Mis Alquileres"})}),pe.jsx("li",{children:pe.jsx("button",{onClick:()=>e("/login"),className:"text-gray-400 hover:text-white transition-colors duration-300",children:"Iniciar Sesión"})})]})]}),pe.jsxs("div",{children:[pe.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Contacto"}),pe.jsxs("div",{className:"space-y-3",children:[pe.jsxs("div",{className:"flex items-center space-x-3",children:[pe.jsx(g,{className:"w-5 h-5 text-primary-400"}),pe.jsx("span",{className:"text-gray-400",children:"info@rentmenow.com"})]}),pe.jsxs("div",{className:"flex items-center space-x-3",children:[pe.jsx(y,{className:"w-5 h-5 text-primary-400"}),pe.jsx("span",{className:"text-gray-400",children:"+34 900 123 456"})]}),pe.jsxs("div",{className:"flex items-center space-x-3",children:[pe.jsx(j,{className:"w-5 h-5 text-primary-400"}),pe.jsx("span",{className:"text-gray-400",children:"Madrid, España"})]})]})]})]}),pe.jsxs("div",{className:"border-t border-gray-800 mt-12 pt-8 flex flex-col md:flex-row items-center justify-between",children:[pe.jsx("p",{className:"text-gray-400 text-sm",children:"© 2024 RentMeNow. Todos los derechos reservados."}),pe.jsxs("div",{className:"flex space-x-6 mt-4 md:mt-0",children:[pe.jsx("span",{className:"text-gray-400 hover:text-white text-sm transition-colors duration-300 cursor-pointer",children:"Política de Privacidad"}),pe.jsx("span",{className:"text-gray-400 hover:text-white text-sm transition-colors duration-300 cursor-pointer",children:"Términos de Servicio"}),pe.jsx("span",{className:"text-gray-400 hover:text-white text-sm transition-colors duration-300 cursor-pointer",children:"Cookies"})]})]})]})})},be=()=>{const[s,a]=e.useState(!1);e.useEffect((()=>{const e=localStorage.getItem("token");a(!!e)}),[]);const i=[{icon:r,title:"Propiedades Verificadas",description:"Todas las propiedades están verificadas y son seguras para alquilar"},{icon:c,title:"Gestión Fácil",description:"Administra tus alquileres de forma simple y eficiente"},{icon:N,title:"Comunidad Confiable",description:"Conecta con propietarios e inquilinos verificados"},{icon:f,title:"Mejor Experiencia",description:"Sistema intuitivo y soporte 24/7 para todos los usuarios"}];return pe.jsxs("div",{className:"min-h-screen",children:[pe.jsxs("section",{className:"relative overflow-hidden pt-20 pb-32 px-4",children:[pe.jsx("div",{className:"max-w-7xl mx-auto",children:pe.jsxs("div",{className:"text-center",children:[pe.jsxs(t.h1,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8},className:"text-5xl md:text-7xl font-bold mb-6",children:[pe.jsx("span",{className:"bg-gradient-to-r from-primary-600 via-secondary-600 to-primary-600 bg-clip-text text-transparent",children:"Encuentra tu"}),pe.jsx("br",{}),pe.jsx("span",{className:"text-gray-800",children:"hogar perfecto"})]}),pe.jsx(t.p,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},className:"text-xl text-gray-600 mb-8 max-w-2xl mx-auto",children:"La plataforma más completa para alquilar y gestionar propiedades. Conectamos propietarios e inquilinos de forma segura y eficiente."}),!s&&pe.jsxs(t.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8,delay:.4},className:"flex flex-col sm:flex-row items-center justify-center gap-4 mb-12",children:[pe.jsxs("a",{href:"/properties",className:"btn-primary text-lg px-8 py-4",children:[pe.jsx(b,{className:"w-5 h-5 mr-2"}),"Explorar Propiedades"]}),pe.jsxs("a",{href:"/register",className:"btn-secondary text-lg px-8 py-4",children:[pe.jsx(r,{className:"w-5 h-5 mr-2"}),"Unirse Gratis"]})]})]})}),pe.jsxs("div",{className:"absolute inset-0 -z-10",children:[pe.jsx(t.div,{animate:{y:[0,-20,0]},transition:{duration:6,repeat:1/0},className:"absolute top-20 left-10 w-20 h-20 bg-primary-200 rounded-full opacity-20"}),pe.jsx(t.div,{animate:{y:[0,20,0]},transition:{duration:8,repeat:1/0},className:"absolute top-40 right-20 w-32 h-32 bg-secondary-200 rounded-full opacity-20"}),pe.jsx(t.div,{animate:{y:[0,-15,0]},transition:{duration:7,repeat:1/0},className:"absolute bottom-20 left-1/4 w-16 h-16 bg-primary-300 rounded-full opacity-20"})]})]}),pe.jsx("section",{className:"py-20 px-4",children:pe.jsxs("div",{className:"max-w-7xl mx-auto",children:[pe.jsxs(t.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.8},className:"text-center mb-16",children:[pe.jsx("h2",{className:"text-4xl font-bold text-gray-800 mb-4",children:"¿Por qué elegir RentMeNow?"}),pe.jsx("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto",children:"Ofrecemos las mejores herramientas para que encuentres o rentes tu propiedad ideal"})]}),pe.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:i.map(((e,s)=>pe.jsxs(t.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.8,delay:.2*s},whileHover:{y:-5},className:"card p-6 text-center group",children:[pe.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-primary-500 to-secondary-500 rounded-2xl flex items-center justify-center mx-auto mb-4 group-hover:scale-110 transition-transform duration-300",children:pe.jsx(e.icon,{className:"w-8 h-8 text-white"})}),pe.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e.title}),pe.jsx("p",{className:"text-gray-600",children:e.description})]},s)))})]})}),!s&&pe.jsx("section",{className:"py-20 px-4",children:pe.jsx("div",{className:"max-w-4xl mx-auto",children:pe.jsxs(t.div,{initial:{opacity:0,scale:.9},whileInView:{opacity:1,scale:1},transition:{duration:.8},className:"card p-12 text-center bg-gradient-to-r from-primary-500 to-secondary-500 text-white",children:[pe.jsx("h2",{className:"text-4xl font-bold mb-4",children:"¿Listo para comenzar?"}),pe.jsx("p",{className:"text-xl mb-8 opacity-90",children:"Únete a miles de usuarios que ya confían en RentMeNow para sus necesidades de alquiler"}),pe.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4",children:[pe.jsx("a",{href:"/register",className:"bg-white text-primary-600 px-8 py-4 rounded-xl font-semibold hover:bg-gray-50 transition-all duration-300 transform hover:scale-105",children:"Crear Cuenta Gratis"}),pe.jsx("a",{href:"/properties",className:"border-2 border-white text-white px-8 py-4 rounded-xl font-semibold hover:bg-white hover:text-primary-600 transition-all duration-300 transform hover:scale-105",children:"Explorar Propiedades"})]})]})})}),pe.jsx("footer",{className:"bg-gray-900 text-white py-16 px-4",children:pe.jsxs("div",{className:"max-w-7xl mx-auto",children:[pe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[pe.jsxs("div",{className:"md:col-span-2",children:[pe.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[pe.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-primary-500 to-secondary-500 rounded-lg flex items-center justify-center",children:pe.jsx(r,{className:"w-5 h-5 text-white"})}),pe.jsx("span",{className:"text-xl font-bold",children:"RentMeNow"})]}),pe.jsx("p",{className:"text-gray-400 mb-6 max-w-md",children:"La plataforma líder en alquiler de propiedades. Conectamos propietarios e inquilinos de forma segura y eficiente en toda España."}),pe.jsxs("div",{className:"flex space-x-4",children:[pe.jsx("div",{className:"w-10 h-10 bg-gray-800 rounded-lg flex items-center justify-center hover:bg-primary-600 transition-colors duration-300 cursor-pointer",children:pe.jsx("span",{className:"text-sm font-bold",children:"f"})}),pe.jsx("div",{className:"w-10 h-10 bg-gray-800 rounded-lg flex items-center justify-center hover:bg-primary-600 transition-colors duration-300 cursor-pointer",children:pe.jsx("span",{className:"text-sm font-bold",children:"t"})}),pe.jsx("div",{className:"w-10 h-10 bg-gray-800 rounded-lg flex items-center justify-center hover:bg-primary-600 transition-colors duration-300 cursor-pointer",children:pe.jsx("span",{className:"text-sm font-bold",children:"in"})})]})]}),pe.jsxs("div",{children:[pe.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Enlaces Rápidos"}),pe.jsxs("ul",{className:"space-y-2",children:[pe.jsx("li",{children:pe.jsx("a",{href:"/properties",className:"text-gray-400 hover:text-white transition-colors duration-300",children:"Propiedades"})}),pe.jsx("li",{children:pe.jsx("a",{href:"/create-property",className:"text-gray-400 hover:text-white transition-colors duration-300",children:"Publicar Propiedad"})}),pe.jsx("li",{children:pe.jsx("a",{href:"/rentals",className:"text-gray-400 hover:text-white transition-colors duration-300",children:"Mis Alquileres"})}),pe.jsx("li",{children:pe.jsx("a",{href:"/login",className:"text-gray-400 hover:text-white transition-colors duration-300",children:"Iniciar Sesión"})})]})]}),pe.jsxs("div",{children:[pe.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Contacto"}),pe.jsxs("div",{className:"space-y-3",children:[pe.jsxs("div",{className:"flex items-center space-x-3",children:[pe.jsx(g,{className:"w-5 h-5 text-primary-400"}),pe.jsx("span",{className:"text-gray-400",children:"info@rentmenow.com"})]}),pe.jsxs("div",{className:"flex items-center space-x-3",children:[pe.jsx(y,{className:"w-5 h-5 text-primary-400"}),pe.jsx("span",{className:"text-gray-400",children:"+34 900 123 456"})]}),pe.jsxs("div",{className:"flex items-center space-x-3",children:[pe.jsx(j,{className:"w-5 h-5 text-primary-400"}),pe.jsx("span",{className:"text-gray-400",children:"Madrid, España"})]})]})]})]}),pe.jsxs("div",{className:"border-t border-gray-800 mt-12 pt-8 flex flex-col md:flex-row items-center justify-between",children:[pe.jsx("p",{className:"text-gray-400 text-sm",children:"© 2024 RentMeNow. Todos los derechos reservados."}),pe.jsxs("div",{className:"flex space-x-6 mt-4 md:mt-0",children:[pe.jsx("a",{href:"#",className:"text-gray-400 hover:text-white text-sm transition-colors duration-300",children:"Política de Privacidad"}),pe.jsx("a",{href:"#",className:"text-gray-400 hover:text-white text-sm transition-colors duration-300",children:"Términos de Servicio"}),pe.jsx("a",{href:"#",className:"text-gray-400 hover:text-white text-sm transition-colors duration-300",children:"Cookies"})]})]})]})})]})},Ne=()=>{const[s,a]=e.useState({username:"",password:""}),[r,l]=e.useState(!1),[n,o]=e.useState(!1),[c,d]=e.useState(""),m=e=>{a({...s,[e.target.name]:e.target.value})},x=(e,s="success")=>{d(e),setTimeout((()=>d("")),4e3)};return pe.jsxs("div",{className:"min-h-screen flex items-center justify-center px-4 py-20",children:[c&&pe.jsx("div",{className:"fixed top-8 left-1/2 transform -translate-x-1/2 z-50",children:pe.jsx("div",{className:"shadow-lg rounded-xl p-4 border-l-4 max-w-md "+(c.includes("Error")?"bg-red-50 border-red-500":"bg-green-50 border-green-500"),children:pe.jsx("p",{className:c.includes("Error")?"text-red-800":"text-green-800",children:c})})}),pe.jsxs(t.div,{initial:{opacity:0,y:30,scale:.9},animate:{opacity:1,y:0,scale:1},transition:{duration:.8},className:"card p-8 w-full max-w-md",children:[pe.jsxs("div",{className:"text-center mb-8",children:[pe.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-primary-500 to-secondary-500 rounded-2xl flex items-center justify-center mx-auto mb-4",children:pe.jsx(v,{className:"w-8 h-8 text-white"})}),pe.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Iniciar Sesión"}),pe.jsx("p",{className:"text-gray-600",children:"Accede a tu cuenta de RentMeNow"})]}),pe.jsxs("form",{onSubmit:async e=>{e.preventDefault(),o(!0),d("");try{const e=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(e.ok){const s=await e.json();localStorage.setItem("token",s.token),localStorage.setItem("user",JSON.stringify(s.user)),x("¡Bienvenido de vuelta!"),setTimeout((()=>{window.location.href="/"}),1e3)}else{const s=await e.text();x(s||"Error al iniciar sesión","error")}}catch(a){x("Error al iniciar sesión","error")}finally{o(!1)}},className:"space-y-6",children:[pe.jsxs("div",{children:[pe.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:"Usuario"}),pe.jsxs("div",{className:"relative",children:[pe.jsx(i,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),pe.jsx("input",{type:"text",id:"username",name:"username",value:s.username,onChange:m,className:"input-field pl-12",placeholder:"Ingresa tu usuario",required:!0})]})]}),pe.jsxs("div",{children:[pe.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Contraseña"}),pe.jsxs("div",{className:"relative",children:[pe.jsx(w,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),pe.jsx("input",{type:r?"text":"password",id:"password",name:"password",value:s.password,onChange:m,className:"input-field pl-12 pr-12",placeholder:"Ingresa tu contraseña",required:!0}),pe.jsx("button",{type:"button",onClick:()=>l(!r),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors duration-300",children:r?pe.jsx(C,{className:"w-5 h-5"}):pe.jsx(S,{className:"w-5 h-5"})})]})]}),pe.jsx(t.button,{type:"submit",disabled:n,whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full btn-primary flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed",children:n?pe.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):pe.jsxs(pe.Fragment,{children:[pe.jsx(v,{className:"w-5 h-5 mr-2"}),"Iniciar Sesión"]})})]}),pe.jsx("div",{className:"mt-6 text-center",children:pe.jsxs("p",{className:"text-gray-600",children:["¿No tienes cuenta?"," ",pe.jsx("a",{href:"/register",className:"text-primary-600 hover:text-primary-700 font-semibold transition-colors duration-300",children:"Regístrate aquí"})]})})]})]})},fe=()=>{const[s,a]=e.useState({username:"",email:"",password:"",confirmPassword:"",firstName:"",lastName:"",phone:""}),[r,l]=e.useState(!1),[n,o]=e.useState(!1),[c,d]=e.useState(!1),m=e=>{a({...s,[e.target.name]:e.target.value})};return pe.jsx("div",{className:"min-h-screen flex items-center justify-center px-4 py-20",children:pe.jsxs(t.div,{initial:{opacity:0,y:30,scale:.9},animate:{opacity:1,y:0,scale:1},transition:{duration:.8},className:"card p-8 w-full max-w-lg",children:[pe.jsxs("div",{className:"text-center mb-8",children:[pe.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-primary-500 to-secondary-500 rounded-2xl flex items-center justify-center mx-auto mb-4",children:pe.jsx(k,{className:"w-8 h-8 text-white"})}),pe.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Crear Cuenta"}),pe.jsx("p",{className:"text-gray-600",children:"Únete a la comunidad RentMeNow"})]}),pe.jsxs("div",{className:"space-y-6",children:[pe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[pe.jsxs("div",{children:[pe.jsx("label",{htmlFor:"firstName",className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre"}),pe.jsxs("div",{className:"relative",children:[pe.jsx(E,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),pe.jsx("input",{type:"text",id:"firstName",name:"firstName",value:s.firstName,onChange:m,className:"input-field pl-12",placeholder:"Tu nombre"})]})]}),pe.jsxs("div",{children:[pe.jsx("label",{htmlFor:"lastName",className:"block text-sm font-medium text-gray-700 mb-2",children:"Apellidos"}),pe.jsxs("div",{className:"relative",children:[pe.jsx(E,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),pe.jsx("input",{type:"text",id:"lastName",name:"lastName",value:s.lastName,onChange:m,className:"input-field pl-12",placeholder:"Tus apellidos"})]})]})]}),pe.jsxs("div",{children:[pe.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:"Usuario *"}),pe.jsxs("div",{className:"relative",children:[pe.jsx(i,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),pe.jsx("input",{type:"text",id:"username",name:"username",value:s.username,onChange:m,className:"input-field pl-12",placeholder:"Elige un nombre de usuario",required:!0})]})]}),pe.jsxs("div",{children:[pe.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email *"}),pe.jsxs("div",{className:"relative",children:[pe.jsx(g,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),pe.jsx("input",{type:"email",id:"email",name:"email",value:s.email,onChange:m,className:"input-field pl-12",placeholder:"tu@email.com",required:!0})]})]}),pe.jsxs("div",{children:[pe.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-2",children:"Teléfono"}),pe.jsxs("div",{className:"relative",children:[pe.jsx(y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),pe.jsx("input",{type:"tel",id:"phone",name:"phone",value:s.phone,onChange:m,className:"input-field pl-12",placeholder:"Tu número de teléfono"})]})]}),pe.jsxs("div",{children:[pe.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Contraseña *"}),pe.jsxs("div",{className:"relative",children:[pe.jsx(w,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),pe.jsx("input",{type:r?"text":"password",id:"password",name:"password",value:s.password,onChange:m,className:"input-field pl-12 pr-12",placeholder:"Mínimo 6 caracteres",required:!0}),pe.jsx("button",{type:"button",onClick:()=>l(!r),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors duration-300",children:r?pe.jsx(C,{className:"w-5 h-5"}):pe.jsx(S,{className:"w-5 h-5"})})]})]}),pe.jsxs("div",{children:[pe.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirmar Contraseña *"}),pe.jsxs("div",{className:"relative",children:[pe.jsx(w,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),pe.jsx("input",{type:n?"text":"password",id:"confirmPassword",name:"confirmPassword",value:s.confirmPassword,onChange:m,className:"input-field pl-12 pr-12",placeholder:"Repite tu contraseña",required:!0}),pe.jsx("button",{type:"button",onClick:()=>o(!n),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors duration-300",children:n?pe.jsx(C,{className:"w-5 h-5"}):pe.jsx(S,{className:"w-5 h-5"})})]})]}),pe.jsx(t.button,{type:"submit",disabled:c,onClick:async e=>{if(e.preventDefault(),s.password===s.confirmPassword)if(s.password.length<6)P.error("La contraseña debe tener al menos 6 caracteres");else{d(!0);try{const{confirmPassword:e,...a}=s,t=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(t.ok)P.success("¡Cuenta creada exitosamente! Inicia sesión para continuar"),window.location.href="/login";else{const e=await t.text();P.error(e||"Error al crear la cuenta")}}catch(a){P.error("Error al crear la cuenta")}finally{d(!1)}}else P.error("Las contraseñas no coinciden")},whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full btn-primary flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed",children:c?pe.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):pe.jsxs(pe.Fragment,{children:[pe.jsx(k,{className:"w-5 h-5 mr-2"}),"Crear Cuenta"]})})]}),pe.jsx("div",{className:"mt-6 text-center",children:pe.jsxs("p",{className:"text-gray-600",children:["¿Ya tienes cuenta?"," ",pe.jsx("a",{href:"/login",className:"text-primary-600 hover:text-primary-700 font-semibold transition-colors duration-300",children:"Inicia sesión aquí"})]})}),pe.jsx("div",{className:"mt-4 text-center text-sm text-gray-500",children:pe.jsx("p",{children:"* Campos obligatorios"})})]})})},ve=({property:s,onClick:a})=>{const[r,l]=e.useState(0),n=s.images&&s.images.length>0,o=n&&s.images.length>1;return pe.jsxs(t.div,{whileHover:{y:-5,scale:1.02},transition:{duration:.3},className:"card p-6 group cursor-pointer",onClick:a,children:[pe.jsxs("div",{className:"relative overflow-hidden rounded-xl mb-4",children:[n?pe.jsxs("div",{className:"relative h-48 group",children:[pe.jsx("img",{src:s.images[r],alt:s.title,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105",onError:e=>{e.target.style.display="none",e.target.nextSibling.style.display="flex"}}),pe.jsx("div",{className:"h-48 bg-gradient-to-br from-primary-400 to-secondary-400 flex items-center justify-center",style:{display:"none"},children:pe.jsx("span",{className:"text-white text-4xl font-bold",children:s.title.charAt(0)})}),o&&pe.jsxs(pe.Fragment,{children:[pe.jsx("button",{onClick:e=>{e.stopPropagation(),o&&l((e=>(e-1+s.images.length)%s.images.length))},className:"absolute left-2 top-1/2 transform -translate-y-1/2 bg-black/50 text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300 hover:bg-black/70",children:pe.jsx(I,{className:"w-4 h-4"})}),pe.jsx("button",{onClick:e=>{e.stopPropagation(),o&&l((e=>(e+1)%s.images.length))},className:"absolute right-2 top-1/2 transform -translate-y-1/2 bg-black/50 text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300 hover:bg-black/70",children:pe.jsx(D,{className:"w-4 h-4"})}),pe.jsx("div",{className:"absolute bottom-2 left-1/2 transform -translate-x-1/2 flex space-x-1",children:s.images.map(((e,s)=>pe.jsx("div",{className:"w-2 h-2 rounded-full transition-colors duration-300 "+(s===r?"bg-white":"bg-white/50")},s)))})]})]}):pe.jsx("div",{className:"h-48 bg-gradient-to-br from-primary-400 to-secondary-400 flex items-center justify-center",children:pe.jsx("span",{className:"text-white text-4xl font-bold",children:s.title.charAt(0)})}),pe.jsx("div",{className:"absolute top-3 right-3 flex flex-col space-y-1",children:s.available?pe.jsx("div",{className:"bg-green-500 text-white px-2 py-1 rounded-full text-xs font-semibold",children:"Disponible"}):pe.jsxs(pe.Fragment,{children:[pe.jsx("div",{className:"bg-red-500 text-white px-2 py-1 rounded-full text-xs font-semibold",children:"Ocupado"}),s.occupiedUntil&&pe.jsxs("div",{className:"bg-orange-500 text-white px-2 py-1 rounded-full text-xs font-semibold flex items-center",children:[pe.jsx(A,{className:"w-3 h-3 mr-1"}),(c=s.occupiedUntil,c?new Date(c).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"}):null)]})]})})]}),pe.jsxs("div",{className:"space-y-3",children:[pe.jsx("h3",{className:"text-xl font-semibold text-gray-800 group-hover:text-primary-600 transition-colors duration-300",children:s.title}),pe.jsx("p",{className:"text-gray-600 text-sm line-clamp-2",children:s.description}),pe.jsxs("div",{className:"flex items-center text-gray-500 text-sm",children:[pe.jsx(j,{className:"w-4 h-4 mr-1"}),pe.jsxs("span",{children:[s.address,", ",s.city]})]}),pe.jsxs("div",{className:"flex items-center justify-between",children:[pe.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[pe.jsxs("div",{className:"flex items-center",children:[pe.jsx(M,{className:"w-4 h-4 mr-1"}),pe.jsx("span",{children:s.bedrooms})]}),pe.jsxs("div",{className:"flex items-center",children:[pe.jsx(R,{className:"w-4 h-4 mr-1"}),pe.jsx("span",{children:s.bathrooms})]})]}),pe.jsxs("div",{className:"flex items-center text-primary-600 font-semibold",children:[pe.jsx(O,{className:"w-4 h-4 mr-1"}),pe.jsxs("span",{children:[s.price,"/mes"]})]})]}),pe.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-gray-100",children:[pe.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[pe.jsx(i,{className:"w-4 h-4 mr-1"}),pe.jsx("span",{className:"hover:text-primary-600 transition-colors duration-300 cursor-pointer",children:s.ownerUsername})]}),s.categoryName&&pe.jsx("span",{className:"bg-primary-100 text-primary-700 px-2 py-1 rounded-full text-xs font-medium",children:s.categoryName})]})]})]});var c},we=()=>{const[s,a]=e.useState([]),[r,i]=e.useState([]),[l,n]=e.useState(!0),[o,c]=e.useState("grid"),[d,m]=e.useState({search:"",city:"",minPrice:"",maxPrice:"",bedrooms:"",available:"all"});e.useEffect((()=>{x()}),[]),e.useEffect((()=>{h()}),[s,d]);const x=async()=>{try{const e=await fetch("/api/properties"),s=await e.json();a(s)}catch(e){P.error("Error al cargar las propiedades")}finally{n(!1)}},h=()=>{let e=[...s];if(d.search&&(e=e.filter((e=>e.title.toLowerCase().includes(d.search.toLowerCase())||e.description.toLowerCase().includes(d.search.toLowerCase())||e.address.toLowerCase().includes(d.search.toLowerCase())))),d.city&&(e=e.filter((e=>e.city.toLowerCase().includes(d.city.toLowerCase())))),d.minPrice&&(e=e.filter((e=>parseFloat(e.price)>=parseFloat(d.minPrice)))),d.maxPrice&&(e=e.filter((e=>parseFloat(e.price)<=parseFloat(d.maxPrice)))),d.bedrooms){const s=parseInt(d.bedrooms);!isNaN(s)&&s>0&&(e=e.filter((e=>e.bedrooms>=s)))}"all"!==d.available&&(e=e.filter((e=>e.available===("true"===d.available)))),i(e)},p=e=>{const{name:s,value:a}=e.target;"bedrooms"===s&&""!==a&&(isNaN(a)||parseInt(a)<0)||m({...d,[s]:a})},u=()=>{m({search:"",city:"",minPrice:"",maxPrice:"",bedrooms:"",available:"all"})},g=e=>{window.location.href=`/properties/${e}`},y=e=>e?new Date(e).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"}):null,N=[...new Set(s.map((e=>e.city)))].sort(),f=({property:s})=>{const[a,t]=e.useState(0),r=s.images&&s.images.length>0,i=r&&s.images.length>1;return pe.jsxs("div",{className:"relative h-48 bg-gradient-to-br from-primary-400 to-secondary-400 rounded-xl overflow-hidden group",children:[r?pe.jsxs(pe.Fragment,{children:[pe.jsx("img",{src:s.images[a],alt:s.title,className:"w-full h-full object-cover",onError:e=>{e.target.style.display="none",e.target.nextSibling.style.display="flex"}}),pe.jsx("div",{className:"w-full h-full bg-gradient-to-br from-primary-400 to-secondary-400 flex items-center justify-center absolute top-0 left-0",style:{display:"none"},children:pe.jsx("span",{className:"text-white text-4xl font-bold",children:s.title.charAt(0)})})]}):pe.jsx("div",{className:"w-full h-full flex items-center justify-center",children:pe.jsx("span",{className:"text-white text-4xl font-bold",children:s.title.charAt(0)})}),i&&pe.jsxs(pe.Fragment,{children:[pe.jsx("button",{onClick:e=>{e.stopPropagation(),i&&t((e=>(e-1+s.images.length)%s.images.length))},className:"absolute left-2 top-1/2 transform -translate-y-1/2 bg-black/50 text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:pe.jsx(I,{className:"w-4 h-4"})}),pe.jsx("button",{onClick:e=>{e.stopPropagation(),i&&t((e=>(e+1)%s.images.length))},className:"absolute right-2 top-1/2 transform -translate-y-1/2 bg-black/50 text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:pe.jsx(D,{className:"w-4 h-4"})})]}),pe.jsx("div",{className:"absolute top-3 right-3 flex flex-col space-y-1",children:s.available?pe.jsx("div",{className:"bg-green-500 text-white px-2 py-1 rounded-full text-xs font-semibold",children:"Disponible"}):pe.jsxs(pe.Fragment,{children:[pe.jsx("div",{className:"bg-red-500 text-white px-2 py-1 rounded-full text-xs font-semibold",children:"Ocupado"}),s.occupiedUntil&&pe.jsxs("div",{className:"bg-orange-500 text-white px-2 py-1 rounded-full text-xs font-semibold flex items-center",children:[pe.jsx(A,{className:"w-3 h-3 mr-1"}),y(s.occupiedUntil)]})]})})]})};return l?pe.jsx("div",{className:"min-h-screen flex items-center justify-center",children:pe.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-500"})}):pe.jsx("div",{className:"min-h-screen pt-20 px-4",children:pe.jsxs("div",{className:"max-w-7xl mx-auto",children:[pe.jsxs(t.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8},className:"text-center mb-12",children:[pe.jsx("h1",{className:"text-4xl font-bold text-gray-800 mb-4",children:"Encuentra tu Propiedad Ideal"}),pe.jsx("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto",children:"Explora nuestra amplia selección de propiedades disponibles para alquilar"})]}),pe.jsxs(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},className:"card p-6 mb-8",children:[pe.jsxs("div",{className:"flex items-center justify-between mb-6",children:[pe.jsxs("h2",{className:"text-2xl font-semibold text-gray-800 flex items-center",children:[pe.jsx(T,{className:"w-6 h-6 mr-2"}),"Filtros"]}),pe.jsx("button",{onClick:u,className:"text-primary-600 hover:text-primary-700 font-medium transition-colors duration-300",children:"Limpiar Filtros"})]}),pe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[pe.jsx("div",{className:"lg:col-span-2",children:pe.jsxs("div",{className:"relative",children:[pe.jsx(b,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),pe.jsx("input",{type:"text",name:"search",value:d.search,onChange:p,placeholder:"Buscar por título, descripción o dirección...",className:"input-field pl-12"})]})}),pe.jsx("div",{children:pe.jsxs("select",{name:"city",value:d.city,onChange:p,className:"input-field",children:[pe.jsx("option",{value:"",children:"Todas las ciudades"}),N.map((e=>pe.jsx("option",{value:e,children:e},e)))]})}),pe.jsx("div",{children:pe.jsxs("select",{name:"available",value:d.available,onChange:p,className:"input-field",children:[pe.jsx("option",{value:"all",children:"Todas"}),pe.jsx("option",{value:"true",children:"Disponibles"}),pe.jsx("option",{value:"false",children:"Ocupadas"})]})}),pe.jsx("div",{children:pe.jsxs("div",{className:"relative",children:[pe.jsx(O,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),pe.jsx("input",{type:"number",name:"minPrice",value:d.minPrice,onChange:p,placeholder:"Precio mínimo",className:"input-field pl-12",min:"0"})]})}),pe.jsx("div",{children:pe.jsxs("div",{className:"relative",children:[pe.jsx(O,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),pe.jsx("input",{type:"number",name:"maxPrice",value:d.maxPrice,onChange:p,placeholder:"Precio máximo",className:"input-field pl-12",min:"0"})]})}),pe.jsx("div",{children:pe.jsxs("div",{className:"relative",children:[pe.jsx(M,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),pe.jsx("input",{type:"number",name:"bedrooms",value:d.bedrooms,onChange:p,placeholder:"Habitaciones mínimas",className:"input-field pl-12",min:"0"})]})})]})]}),pe.jsxs(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.4},className:"flex items-center justify-between mb-8",children:[pe.jsxs("div",{children:[pe.jsxs("h3",{className:"text-2xl font-semibold text-gray-800",children:[r.length," Propiedades Encontradas"]}),pe.jsxs("p",{className:"text-gray-600 mt-1",children:[r.filter((e=>e.available)).length," disponibles para alquilar"]})]}),pe.jsxs("div",{className:"flex items-center space-x-2",children:[pe.jsx("button",{onClick:()=>c("grid"),className:"p-2 rounded-lg transition-colors duration-300 "+("grid"===o?"bg-primary-500 text-white":"bg-gray-200 text-gray-600 hover:bg-gray-300"),children:pe.jsx(q,{className:"w-5 h-5"})}),pe.jsx("button",{onClick:()=>c("list"),className:"p-2 rounded-lg transition-colors duration-300 "+("list"===o?"bg-primary-500 text-white":"bg-gray-200 text-gray-600 hover:bg-gray-300"),children:pe.jsx(L,{className:"w-5 h-5"})})]})]}),0===r.length?pe.jsxs(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.6},className:"text-center py-20",children:[pe.jsx("div",{className:"w-24 h-24 bg-gray-200 rounded-full flex items-center justify-center mx-auto mb-6",children:pe.jsx(b,{className:"w-12 h-12 text-gray-400"})}),pe.jsx("h3",{className:"text-2xl font-semibold text-gray-800 mb-2",children:"No se encontraron propiedades"}),pe.jsx("p",{className:"text-gray-600 mb-6",children:"Intenta ajustar tus filtros para encontrar más resultados"}),pe.jsx("button",{onClick:u,className:"btn-primary",children:"Limpiar Filtros"})]}):pe.jsx("div",{className:"grid gap-8 "+("grid"===o?"grid-cols-1 md:grid-cols-2 lg:grid-cols-3":"grid-cols-1"),children:r.map(((e,s)=>pe.jsx(t.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8,delay:.1*s},children:"grid"===o?pe.jsx(ve,{property:e,onClick:()=>g(e.id)}):pe.jsxs("div",{className:"card p-6 flex flex-col md:flex-row space-y-4 md:space-y-0 md:space-x-6 cursor-pointer hover:shadow-xl transition-shadow duration-300",onClick:()=>g(e.id),children:[pe.jsx("div",{className:"md:w-1/3",children:pe.jsx(f,{property:e})}),pe.jsxs("div",{className:"md:w-2/3 space-y-3",children:[pe.jsxs("div",{className:"flex items-start justify-between",children:[pe.jsx("h3",{className:"text-2xl font-semibold text-gray-800 hover:text-primary-600 transition-colors duration-300",children:e.title}),pe.jsxs("div",{className:"flex items-center text-primary-600 font-bold text-xl",children:[pe.jsx(O,{className:"w-5 h-5 mr-1"}),pe.jsxs("span",{children:[e.price,"/mes"]})]})]}),pe.jsx("p",{className:"text-gray-600",children:e.description}),pe.jsxs("div",{className:"flex items-center text-gray-500",children:[pe.jsx(j,{className:"w-4 h-4 mr-1"}),pe.jsxs("span",{children:[e.address,", ",e.city]})]}),!e.available&&e.occupiedUntil&&pe.jsxs("div",{className:"flex items-center text-orange-600 bg-orange-50 px-3 py-2 rounded-lg",children:[pe.jsx(A,{className:"w-4 h-4 mr-2"}),pe.jsxs("span",{className:"text-sm font-medium",children:["Disponible desde: ",y(e.occupiedUntil)]})]}),pe.jsxs("div",{className:"flex items-center justify-between",children:[pe.jsxs("div",{className:"flex items-center space-x-6 text-gray-600",children:[pe.jsxs("div",{className:"flex items-center",children:[pe.jsx(M,{className:"w-5 h-5 mr-2"}),pe.jsxs("span",{children:[e.bedrooms," habitaciones"]})]}),pe.jsxs("div",{className:"flex items-center",children:[pe.jsx(R,{className:"w-5 h-5 mr-2"}),pe.jsxs("span",{children:[e.bathrooms," baños"]})]})]}),e.categoryName&&pe.jsx("span",{className:"bg-primary-100 text-primary-700 px-3 py-1 rounded-full text-sm font-medium",children:e.categoryName})]}),pe.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-gray-100",children:[pe.jsxs("div",{className:"text-sm text-gray-500",children:["Propietario:",pe.jsx("span",{className:"text-primary-600 hover:text-primary-700 ml-1 cursor-pointer font-medium",children:e.ownerUsername})]}),pe.jsx("div",{className:"flex space-x-2",children:e.available?pe.jsx("span",{className:"bg-green-100 text-green-700 px-3 py-1 rounded-full text-sm font-medium",children:"Solicitar Alquiler"}):pe.jsx("span",{className:"bg-orange-100 text-orange-700 px-3 py-1 rounded-full text-sm font-medium",children:"Solicitar para Futuro"})})]})]})]})},e.id)))})]})})},Ce=()=>{const[s,a]=e.useState(null),[r,l]=e.useState(null),[n,o]=e.useState(!1),[m,x]=e.useState(!0),[p,u]=e.useState(0),[g,y]=e.useState(""),[b,N]=e.useState(!1),[f,v]=e.useState({}),[w,C]=e.useState({});e.useEffect((()=>{const e=localStorage.getItem("token"),s=localStorage.getItem("user");if(e&&s)try{const e=JSON.parse(s);l(e),o(!0)}catch(r){localStorage.removeItem("token"),localStorage.removeItem("user")}const a=window.location.pathname.split("/"),t=a[a.length-1];t&&!isNaN(t)?S(t):x(!1)}),[]);const S=async e=>{try{const s=await fetch(`/api/properties/${e}`);if(s.ok){const e=await s.json();a(e),v(e)}else y("Error al cargar la propiedad"),setTimeout((()=>{window.location.href="/properties"}),2e3)}catch(s){y("Error al cargar la propiedad"),setTimeout((()=>{window.location.href="/properties"}),2e3)}finally{x(!1)}},k=e=>{const{name:s,value:a,type:t}=e.target;w[s]&&C({...w,[s]:""});let r=a;"number"===t&&("bedrooms"===s||"bathrooms"===s?r=""===a?"":parseInt(a)||"":"price"===s&&(r=""===a?"":parseFloat(a)||"")),v({...f,[s]:r})},E=e=>e?new Date(e).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}):null,A=r&&(r.username===(null==s?void 0:s.ownerUsername)||"ADMIN"===r.role),T=n&&(null==s?void 0:s.available)&&(null==r?void 0:r.username)!==(null==s?void 0:s.ownerUsername);return m?pe.jsx("div",{className:"min-h-screen flex items-center justify-center",children:pe.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-500"})}):s?pe.jsxs("div",{className:"min-h-screen pt-20 px-4",children:[g&&pe.jsx("div",{className:"fixed top-8 left-1/2 transform -translate-x-1/2 z-50",children:pe.jsx("div",{className:"shadow-lg rounded-xl p-4 border-l-4 max-w-md "+(g.includes("Error")?"bg-red-50 border-red-500":"bg-green-50 border-green-500"),children:pe.jsx("p",{className:g.includes("Error")?"text-red-800":"text-green-800",children:g})})}),pe.jsxs("div",{className:"max-w-6xl mx-auto",children:[pe.jsxs(t.button,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5},onClick:()=>{window.history.back()},className:"flex items-center text-gray-600 hover:text-primary-600 transition-colors duration-300 mb-8",children:[pe.jsx(F,{className:"w-5 h-5 mr-2"}),"Volver"]}),pe.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[pe.jsxs("div",{className:"lg:col-span-2",children:[pe.jsx(t.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8},className:"relative overflow-hidden rounded-2xl mb-8",children:pe.jsxs("div",{className:"relative h-96 group",children:[s.images&&s.images.length>0?pe.jsxs(pe.Fragment,{children:[pe.jsx("img",{src:s.images[p],alt:s.title,className:"w-full h-full object-cover",onError:e=>{e.target.style.display="none",e.target.nextSibling.style.display="flex"}}),pe.jsx("div",{className:"h-96 bg-gradient-to-br from-primary-400 to-secondary-400 flex items-center justify-center",style:{display:"none"},children:pe.jsx("span",{className:"text-white text-8xl font-bold",children:s.title.charAt(0)})}),s.images.length>1&&pe.jsxs(pe.Fragment,{children:[pe.jsx("button",{onClick:()=>{s.images&&s.images.length>1&&u((e=>(e-1+s.images.length)%s.images.length))},className:"absolute left-6 top-1/2 transform -translate-y-1/2 bg-black/50 text-white p-2 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:pe.jsx(I,{className:"w-6 h-6"})}),pe.jsx("button",{onClick:()=>{s.images&&s.images.length>1&&u((e=>(e+1)%s.images.length))},className:"absolute right-6 top-1/2 transform -translate-y-1/2 bg-black/50 text-white p-2 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:pe.jsx(D,{className:"w-6 h-6"})}),pe.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex space-x-2",children:s.images.map(((e,s)=>pe.jsx("button",{onClick:()=>u(s),className:"w-3 h-3 rounded-full transition-colors duration-300 "+(s===p?"bg-white":"bg-white/50")},s)))})]})]}):pe.jsx("div",{className:"h-96 bg-gradient-to-br from-primary-400 to-secondary-400 flex items-center justify-center",children:pe.jsx("span",{className:"text-white text-8xl font-bold",children:s.title.charAt(0)})}),pe.jsx("div",{className:"absolute top-6 right-6",children:s.available?pe.jsxs("div",{className:"bg-green-500 text-white px-4 py-2 rounded-full font-semibold flex items-center",children:[pe.jsx(U,{className:"w-5 h-5 mr-2"}),"Disponible"]}):pe.jsxs("div",{className:"flex flex-col space-y-2",children:[pe.jsxs("div",{className:"bg-red-500 text-white px-4 py-2 rounded-full font-semibold flex items-center",children:[pe.jsx($,{className:"w-5 h-5 mr-2"}),"Ocupado"]}),s.occupiedUntil&&pe.jsxs("div",{className:"bg-orange-500 text-white px-3 py-1 rounded-full text-sm font-semibold",children:["Hasta: ",E(s.occupiedUntil)]})]})})]})}),pe.jsxs(t.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},className:"card p-8 mb-8",children:[pe.jsxs("div",{className:"flex items-start justify-between mb-6",children:[pe.jsx("div",{className:"flex-1",children:b?pe.jsxs("div",{className:"space-y-4",children:[pe.jsxs("div",{children:[pe.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Título de la Propiedad *"}),pe.jsx("input",{type:"text",name:"title",value:f.title||"",onChange:k,className:"w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-transparent "+(w.title?"border-red-500":"border-gray-300"),placeholder:"Título de la propiedad"}),w.title&&pe.jsx("p",{className:"text-red-500 text-sm mt-1",children:w.title})]}),pe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[pe.jsxs("div",{children:[pe.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dirección *"}),pe.jsx("input",{type:"text",name:"address",value:f.address||"",onChange:k,className:"w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-transparent "+(w.address?"border-red-500":"border-gray-300"),placeholder:"Dirección"}),w.address&&pe.jsx("p",{className:"text-red-500 text-sm mt-1",children:w.address})]}),pe.jsxs("div",{children:[pe.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ciudad *"}),pe.jsx("input",{type:"text",name:"city",value:f.city||"",onChange:k,className:"w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-transparent "+(w.city?"border-red-500":"border-gray-300"),placeholder:"Ciudad"}),w.city&&pe.jsx("p",{className:"text-red-500 text-sm mt-1",children:w.city})]})]})]}):pe.jsxs("div",{children:[pe.jsx("h1",{className:"text-4xl font-bold text-gray-800 mb-2",children:s.title}),pe.jsxs("div",{className:"flex items-center text-gray-600 text-lg",children:[pe.jsx(j,{className:"w-5 h-5 mr-2"}),pe.jsxs("span",{children:[s.address,", ",s.city]})]})]})}),A&&pe.jsx("div",{className:"flex items-center space-x-2",children:b?pe.jsxs(pe.Fragment,{children:[pe.jsx("button",{onClick:()=>{N(!1),v({...s}),C({})},className:"p-2 bg-gray-100 text-gray-600 rounded-lg hover:bg-gray-200 transition-colors duration-300",children:pe.jsx(h,{className:"w-5 h-5"})}),pe.jsx("button",{onClick:async()=>{if((()=>{const e={};if(f.title&&f.title.trim()?f.title.trim().length<5&&(e.title="El título debe tener al menos 5 caracteres"):e.title="El título es obligatorio",f.description&&f.description.trim()?f.description.trim().length<20&&(e.description="La descripción debe tener al menos 20 caracteres"):e.description="La descripción es obligatoria",f.address&&f.address.trim()||(e.address="La dirección es obligatoria"),f.city&&f.city.trim()||(e.city="La ciudad es obligatoria"),f.price&&""!==f.price){const s=parseFloat(f.price);isNaN(s)||s<=0?e.price="El precio debe ser un número mayor a 0":s>5e6&&(e.price="El precio no puede ser mayor a €5,000,000")}else e.price="El precio es obligatorio";return!f.bedrooms||f.bedrooms<1?e.bedrooms="Debe tener al menos 1 habitación":f.bedrooms>100&&(e.bedrooms="Máximo 100 habitaciones"),!f.bathrooms||f.bathrooms<1?e.bathrooms="Debe tener al menos 1 baño":f.bathrooms>100&&(e.bathrooms="Máximo 100 baños"),C(e),0===Object.keys(e).length})())try{const e=await fetch(`/api/properties/${s.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({...f,price:parseFloat(f.price),bedrooms:parseInt(f.bedrooms),bathrooms:parseInt(f.bathrooms)})});if(e.ok){const s=await e.json();a(s),v(s),N(!1),C({}),P.success("Propiedad actualizada exitosamente")}else P.error("Error al actualizar la propiedad")}catch(e){console.error("Error updating property:",e),P.error("Error al actualizar la propiedad")}else P.error("Por favor, corrige los errores en el formulario")},className:"p-2 bg-green-100 text-green-600 rounded-lg hover:bg-green-200 transition-colors duration-300",children:pe.jsx(z,{className:"w-5 h-5"})})]}):pe.jsxs(pe.Fragment,{children:[pe.jsx("button",{onClick:()=>{N(!0),v({...s}),C({})},className:"p-2 bg-primary-100 text-primary-600 rounded-lg hover:bg-primary-200 transition-colors duration-300",children:pe.jsx(H,{className:"w-5 h-5"})}),pe.jsx("button",{onClick:async()=>{if(window.confirm("¿Estás seguro de que quieres eliminar esta propiedad?"))try{(await fetch(`/api/properties/${s.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).ok?(P.success("Propiedad eliminada exitosamente"),setTimeout((()=>{window.location.href="/dashboard"}),1e3)):P.error("Error al eliminar la propiedad")}catch(e){P.error("Error al eliminar la propiedad")}},className:"p-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 transition-colors duration-300",children:pe.jsx(B,{className:"w-5 h-5"})})]})})]}),b?pe.jsxs("div",{className:"space-y-6",children:[pe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[pe.jsxs("div",{children:[pe.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Precio por Mes (€) *"}),pe.jsxs("div",{className:"relative",children:[pe.jsx(O,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),pe.jsx("input",{type:"number",name:"price",value:f.price||"",onChange:k,className:"w-full pl-12 pr-4 py-3 border rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-transparent "+(w.price?"border-red-500":"border-gray-300"),placeholder:"Precio",min:"0",max:"5000000",step:"0.01"})]}),w.price&&pe.jsx("p",{className:"text-red-500 text-sm mt-1",children:w.price})]}),pe.jsxs("div",{children:[pe.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Habitaciones *"}),pe.jsxs("div",{className:"relative",children:[pe.jsx(M,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),pe.jsx("input",{type:"number",name:"bedrooms",value:f.bedrooms||"",onChange:k,className:"w-full pl-12 pr-4 py-3 border rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-transparent "+(w.bedrooms?"border-red-500":"border-gray-300"),placeholder:"Habitaciones",min:"1",max:"100"})]}),w.bedrooms&&pe.jsx("p",{className:"text-red-500 text-sm mt-1",children:w.bedrooms})]}),pe.jsxs("div",{children:[pe.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Baños *"}),pe.jsxs("div",{className:"relative",children:[pe.jsx(R,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),pe.jsx("input",{type:"number",name:"bathrooms",value:f.bathrooms||"",onChange:k,className:"w-full pl-12 pr-4 py-3 border rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-transparent "+(w.bathrooms?"border-red-500":"border-gray-300"),placeholder:"Baños",min:"1",max:"100"})]}),w.bathrooms&&pe.jsx("p",{className:"text-red-500 text-sm mt-1",children:w.bathrooms})]})]}),pe.jsxs("div",{children:[pe.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Descripción *"}),pe.jsx("textarea",{name:"description",value:f.description||"",onChange:k,rows:4,className:"w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-none "+(w.description?"border-red-500":"border-gray-300"),placeholder:"Descripción de la propiedad..."}),w.description&&pe.jsx("p",{className:"text-red-500 text-sm mt-1",children:w.description})]}),pe.jsxs("div",{children:[pe.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Imágenes de la Propiedad"}),pe.jsxs("button",{type:"button",onClick:()=>{const e=prompt("Ingresa la URL de la nueva imagen:");e&&e.trim()&&v({...f,images:[...f.images||[],e.trim()]})},className:"w-full border-2 border-dashed border-gray-300 rounded-xl p-4 text-center hover:border-primary-400 hover:bg-primary-50 transition-colors duration-300 mb-4",children:[pe.jsx(d,{className:"w-6 h-6 text-gray-400 mx-auto mb-2"}),pe.jsx("p",{className:"text-gray-600",children:"Agregar URL de imagen"})]}),f.images&&f.images.length>0&&pe.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:f.images.map(((e,s)=>pe.jsxs("div",{className:"relative group",children:[pe.jsx("img",{src:e,alt:`Imagen ${s+1}`,className:"w-full h-32 object-cover rounded-lg",onError:e=>{e.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDIwMCAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMTI4IiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik04NyA3NEw3NCA2MUw2MSA3NEw3NCA4N0w4NyA3NFoiIGZpbGw9IiM5Q0EzQUYiLz4KPHN2Zz4K"}}),pe.jsx("button",{onClick:()=>(e=>{v({...f,images:f.images.filter(((s,a)=>a!==e))})})(s),className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:pe.jsx(h,{className:"w-4 h-4"})})]},s)))})]}),Object.keys(w).length>0&&pe.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[pe.jsx("h4",{className:"text-red-800 font-semibold mb-2",children:"⚠️ Corrige los siguientes errores:"}),pe.jsx("ul",{className:"text-red-700 text-sm space-y-1",children:Object.entries(w).map((([e,s])=>pe.jsxs("li",{children:["• ",s]},e)))})]})]}):pe.jsxs("div",{children:[pe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[pe.jsxs("div",{className:"flex items-center space-x-3 p-4 bg-gray-50 rounded-xl",children:[pe.jsx("div",{className:"w-12 h-12 bg-primary-100 rounded-lg flex items-center justify-center",children:pe.jsx(M,{className:"w-6 h-6 text-primary-600"})}),pe.jsxs("div",{children:[pe.jsx("p",{className:"text-sm text-gray-600",children:"Habitaciones"}),pe.jsx("p",{className:"text-2xl font-bold text-gray-800",children:s.bedrooms})]})]}),pe.jsxs("div",{className:"flex items-center space-x-3 p-4 bg-gray-50 rounded-xl",children:[pe.jsx("div",{className:"w-12 h-12 bg-secondary-100 rounded-lg flex items-center justify-center",children:pe.jsx(R,{className:"w-6 h-6 text-secondary-600"})}),pe.jsxs("div",{children:[pe.jsx("p",{className:"text-sm text-gray-600",children:"Baños"}),pe.jsx("p",{className:"text-2xl font-bold text-gray-800",children:s.bathrooms})]})]}),pe.jsxs("div",{className:"flex items-center space-x-3 p-4 bg-gray-50 rounded-xl",children:[pe.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:pe.jsx(O,{className:"w-6 h-6 text-green-600"})}),pe.jsxs("div",{children:[pe.jsx("p",{className:"text-sm text-gray-600",children:"Precio/mes"}),pe.jsxs("p",{className:"text-2xl font-bold text-gray-800",children:["€",s.price]})]})]})]}),pe.jsxs("div",{className:"mb-8",children:[pe.jsx("h3",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Descripción"}),pe.jsx("p",{className:"text-gray-600 leading-relaxed text-lg",children:s.description})]}),pe.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-xl",children:[pe.jsxs("div",{className:"flex items-center space-x-3",children:[pe.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-full flex items-center justify-center",children:pe.jsx(i,{className:"w-6 h-6 text-gray-600"})}),pe.jsxs("div",{children:[pe.jsx("p",{className:"text-sm text-gray-600",children:"Propietario"}),pe.jsx("button",{onClick:()=>window.location.href=`/profile/${s.ownerUsername}`,className:"font-semibold text-gray-800 hover:text-primary-600 transition-colors duration-300",children:s.ownerUsername})]})]}),s.categoryName&&pe.jsx("span",{className:"bg-primary-100 text-primary-700 px-4 py-2 rounded-full font-medium",children:s.categoryName})]})]})]})]}),pe.jsx("div",{className:"lg:col-span-1",children:pe.jsxs(t.div,{initial:{opacity:0,x:30},animate:{opacity:1,x:0},transition:{duration:.8,delay:.4},className:"card p-6 sticky top-24",children:[pe.jsxs("div",{className:"text-center mb-6",children:[pe.jsxs("div",{className:"text-4xl font-bold text-primary-600 mb-2",children:["€",b?f.price||0:s.price]}),pe.jsx("p",{className:"text-gray-600",children:"por mes"})]}),!b&&pe.jsx(pe.Fragment,{children:T||!s.available?pe.jsxs("div",{className:"space-y-4",children:[pe.jsxs("button",{onClick:()=>{window.location.href=n?`/create-rental/${s.id}`:"/login"},className:"w-full btn-primary flex items-center justify-center",children:[pe.jsx(c,{className:"w-5 h-5 mr-2"}),s.available?"Solicitar Alquiler":"Solicitar para Futuro"]}),pe.jsx("p",{className:"text-sm text-gray-600 text-center",children:s.available?"Envía una solicitud al propietario":`Disponible desde: ${E(s.occupiedUntil)}`})]}):n?pe.jsxs("div",{className:"text-center",children:[pe.jsx("div",{className:"w-full bg-gray-100 text-gray-700 py-3 rounded-xl font-semibold",children:"Esta es tu propiedad"}),pe.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"No puedes solicitar el alquiler de tu propia propiedad"})]}):pe.jsxs("div",{className:"space-y-4",children:[pe.jsx("button",{onClick:()=>window.location.href="/login",className:"w-full btn-primary flex items-center justify-center",children:"Iniciar Sesión para Solicitar"}),pe.jsx("p",{className:"text-sm text-gray-600 text-center",children:"Necesitas una cuenta para solicitar alquileres"})]})}),pe.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-200",children:[pe.jsx("h4",{className:"font-semibold text-gray-800 mb-4",children:"Detalles de la Propiedad"}),pe.jsxs("div",{className:"space-y-3 text-sm",children:[pe.jsxs("div",{className:"flex justify-between",children:[pe.jsx("span",{className:"text-gray-600",children:"Estado:"}),pe.jsx("span",{className:"font-medium "+(s.available?"text-green-600":"text-red-600"),children:s.available?"Disponible":"Ocupado"})]}),pe.jsxs("div",{className:"flex justify-between",children:[pe.jsx("span",{className:"text-gray-600",children:"Habitaciones:"}),pe.jsx("span",{className:"font-medium text-gray-800",children:b?f.bedrooms||0:s.bedrooms})]}),pe.jsxs("div",{className:"flex justify-between",children:[pe.jsx("span",{className:"text-gray-600",children:"Baños:"}),pe.jsx("span",{className:"font-medium text-gray-800",children:b?f.bathrooms||0:s.bathrooms})]}),pe.jsxs("div",{className:"flex justify-between",children:[pe.jsx("span",{className:"text-gray-600",children:"Ciudad:"}),pe.jsx("span",{className:"font-medium text-gray-800",children:b?f.city||"":s.city})]}),s.categoryName&&pe.jsxs("div",{className:"flex justify-between",children:[pe.jsx("span",{className:"text-gray-600",children:"Categoría:"}),pe.jsx("span",{className:"font-medium text-gray-800",children:s.categoryName})]})]})]})]})})]})]})]}):pe.jsx("div",{className:"min-h-screen flex items-center justify-center",children:pe.jsxs("div",{className:"text-center",children:[g&&pe.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:pe.jsx("p",{className:"text-red-700",children:g})}),pe.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Propiedad no encontrada"}),pe.jsx("button",{onClick:()=>window.location.href="/properties",className:"btn-primary",children:"Volver a Propiedades"})]})})},Se=()=>{const[s,a]=e.useState(!1),[i,l]=e.useState({title:"",description:"",address:"",city:"",price:"",bedrooms:"",bathrooms:"",images:[]}),[n,o]=e.useState({}),c=e=>{const{name:s,value:a,type:t}=e.target;n[s]&&o({...n,[s]:""});let r=a;if("number"===t)if("bedrooms"===s||"bathrooms"===s)if(""===a)r="";else{const e=parseInt(a);if(isNaN(e)||e<0)return;r=e}else if("price"===s)if(""===a)r="";else{const e=parseFloat(a);if(isNaN(e)||e<0)return;r=e}l({...i,[s]:r})},m=()=>{window.history.back()};return pe.jsx("div",{className:"min-h-screen pt-20 px-4",children:pe.jsxs("div",{className:"max-w-4xl mx-auto",children:[pe.jsxs(t.button,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5},onClick:m,className:"flex items-center text-gray-600 hover:text-primary-600 transition-colors duration-300 mb-8",children:[pe.jsx(F,{className:"w-5 h-5 mr-2"}),"Volver"]}),pe.jsxs(t.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8},className:"text-center mb-12",children:[pe.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-primary-500 to-secondary-500 rounded-2xl flex items-center justify-center mx-auto mb-4",children:pe.jsx(r,{className:"w-8 h-8 text-white"})}),pe.jsx("h1",{className:"text-4xl font-bold text-gray-800 mb-4",children:"Crear Nueva Propiedad"}),pe.jsx("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto",children:"Completa la información para publicar tu propiedad en RentMeNow"})]}),pe.jsx(t.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},className:"card p-8",children:pe.jsxs("div",{className:"space-y-8",children:[pe.jsxs("div",{children:[pe.jsxs("h3",{className:"text-2xl font-semibold text-gray-800 mb-6 flex items-center",children:[pe.jsx(G,{className:"w-6 h-6 mr-2"}),"Información Básica"]}),pe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[pe.jsxs("div",{className:"md:col-span-2",children:[pe.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-2",children:"Título de la Propiedad *"}),pe.jsx("input",{type:"text",id:"title",name:"title",value:i.title,onChange:c,className:"input-field "+(n.title?"border-red-500":""),placeholder:"Ej: Hermoso apartamento en el centro"}),n.title&&pe.jsx("p",{className:"text-red-500 text-sm mt-1",children:n.title})]}),pe.jsxs("div",{className:"md:col-span-2",children:[pe.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-2",children:"Descripción *"}),pe.jsx("textarea",{id:"description",name:"description",value:i.description,onChange:c,rows:4,className:"input-field resize-none "+(n.description?"border-red-500":""),placeholder:"Describe tu propiedad, sus características y comodidades..."}),n.description&&pe.jsx("p",{className:"text-red-500 text-sm mt-1",children:n.description}),pe.jsxs("p",{className:"text-gray-500 text-sm mt-1",children:[i.description.length,"/20 caracteres mínimo"]})]})]})]}),pe.jsxs("div",{children:[pe.jsxs("h3",{className:"text-2xl font-semibold text-gray-800 mb-6 flex items-center",children:[pe.jsx(V,{className:"w-6 h-6 mr-2"}),"Imágenes de la Propiedad"]}),pe.jsxs("div",{className:"space-y-4",children:[pe.jsxs("button",{type:"button",onClick:()=>{const e=prompt("Ingresa la URL de la imagen:");e&&e.trim()&&l({...i,images:[...i.images,e.trim()]})},className:"w-full border-2 border-dashed border-gray-300 rounded-xl p-6 text-center hover:border-primary-400 hover:bg-primary-50 transition-colors duration-300",children:[pe.jsx(d,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),pe.jsx("p",{className:"text-gray-600",children:"Agregar URL de imagen"}),pe.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Haz clic para agregar una imagen desde una URL"})]}),i.images.length>0&&pe.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.images.map(((e,s)=>pe.jsxs("div",{className:"relative group",children:[pe.jsx("img",{src:e,alt:`Imagen ${s+1}`,className:"w-full h-32 object-cover rounded-lg",onError:e=>{e.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDIwMCAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMTI4IiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik04NyA3NEw3NCA2MUw2MSA3NEw3NCA4N0w4NyA3NFoiIGZpbGw9IiM5Q0EzQUYiLz4KPHN2Zz4K"}}),pe.jsx("button",{onClick:()=>(e=>{l({...i,images:i.images.filter(((s,a)=>a!==e))})})(s),className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:pe.jsx(h,{className:"w-4 h-4"})}),pe.jsx("div",{className:"absolute bottom-2 left-2 bg-black bg-opacity-50 text-white text-xs px-2 py-1 rounded",children:s+1})]},s)))})]})]}),pe.jsxs("div",{children:[pe.jsxs("h3",{className:"text-2xl font-semibold text-gray-800 mb-6 flex items-center",children:[pe.jsx(j,{className:"w-6 h-6 mr-2"}),"Ubicación"]}),pe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[pe.jsxs("div",{children:[pe.jsx("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700 mb-2",children:"Dirección *"}),pe.jsx("input",{type:"text",id:"address",name:"address",value:i.address,onChange:c,className:"input-field "+(n.address?"border-red-500":""),placeholder:"Calle y número"}),n.address&&pe.jsx("p",{className:"text-red-500 text-sm mt-1",children:n.address})]}),pe.jsxs("div",{children:[pe.jsx("label",{htmlFor:"city",className:"block text-sm font-medium text-gray-700 mb-2",children:"Ciudad *"}),pe.jsx("input",{type:"text",id:"city",name:"city",value:i.city,onChange:c,className:"input-field "+(n.city?"border-red-500":""),placeholder:"Ciudad"}),n.city&&pe.jsx("p",{className:"text-red-500 text-sm mt-1",children:n.city})]})]})]}),pe.jsxs("div",{children:[pe.jsxs("h3",{className:"text-2xl font-semibold text-gray-800 mb-6 flex items-center",children:[pe.jsx(r,{className:"w-6 h-6 mr-2"}),"Detalles de la Propiedad"]}),pe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[pe.jsxs("div",{children:[pe.jsx("label",{htmlFor:"price",className:"block text-sm font-medium text-gray-700 mb-2",children:"Precio por Mes (€) *"}),pe.jsxs("div",{className:"relative",children:[pe.jsx(O,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),pe.jsx("input",{type:"number",id:"price",name:"price",value:i.price,onChange:c,className:"input-field pl-12 "+(n.price?"border-red-500":""),placeholder:"800",min:"0",max:"5000000",step:"0.01"})]}),n.price&&pe.jsx("p",{className:"text-red-500 text-sm mt-1",children:n.price}),pe.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Máximo €5,000,000"})]}),pe.jsxs("div",{children:[pe.jsx("label",{htmlFor:"bedrooms",className:"block text-sm font-medium text-gray-700 mb-2",children:"Habitaciones *"}),pe.jsxs("div",{className:"relative",children:[pe.jsx(M,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),pe.jsx("input",{type:"number",id:"bedrooms",name:"bedrooms",value:i.bedrooms,onChange:c,className:"input-field pl-12 "+(n.bedrooms?"border-red-500":""),placeholder:"Número de habitaciones",min:"1",max:"100"})]}),n.bedrooms&&pe.jsx("p",{className:"text-red-500 text-sm mt-1",children:n.bedrooms}),pe.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Entre 1 y 100 habitaciones"})]}),pe.jsxs("div",{children:[pe.jsx("label",{htmlFor:"bathrooms",className:"block text-sm font-medium text-gray-700 mb-2",children:"Baños *"}),pe.jsxs("div",{className:"relative",children:[pe.jsx(R,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),pe.jsx("input",{type:"number",id:"bathrooms",name:"bathrooms",value:i.bathrooms,onChange:c,className:"input-field pl-12 "+(n.bathrooms?"border-red-500":""),placeholder:"Número de baños",min:"1",max:"100"})]}),n.bathrooms&&pe.jsx("p",{className:"text-red-500 text-sm mt-1",children:n.bathrooms}),pe.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Entre 1 y 100 baños"})]})]})]}),pe.jsxs("div",{className:"flex items-center justify-end space-x-4 pt-6 border-t border-gray-200",children:[pe.jsx("button",{type:"button",onClick:m,className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors duration-300",children:"Cancelar"}),pe.jsxs(t.button,{type:"submit",disabled:s,onClick:async e=>{if(e.preventDefault(),(()=>{const e={};if(i.title.trim()?i.title.trim().length<5&&(e.title="El título debe tener al menos 5 caracteres"):e.title="El título es obligatorio",i.description.trim()?i.description.trim().length<20&&(e.description="La descripción debe tener al menos 20 caracteres"):e.description="La descripción es obligatoria",i.address.trim()||(e.address="La dirección es obligatoria"),i.city.trim()||(e.city="La ciudad es obligatoria"),i.price&&""!==i.price){const s=parseFloat(i.price);isNaN(s)||s<=0?e.price="El precio debe ser un número mayor a 0":s>5e6&&(e.price="El precio no puede ser mayor a €5,000,000")}else e.price="El precio es obligatorio";if(i.bedrooms&&""!==i.bedrooms){const s=parseInt(i.bedrooms);isNaN(s)||s<1?e.bedrooms="Debe tener al menos 1 habitación":s>100&&(e.bedrooms="Máximo 100 habitaciones")}else e.bedrooms="El número de habitaciones es obligatorio";if(i.bathrooms&&""!==i.bathrooms){const s=parseInt(i.bathrooms);isNaN(s)||s<1?e.bathrooms="Debe tener al menos 1 baño":s>100&&(e.bathrooms="Máximo 100 baños")}else e.bathrooms="El número de baños es obligatorio";return o(e),0===Object.keys(e).length})()){a(!0);try{const e={...i,price:parseFloat(i.price),bedrooms:parseInt(i.bedrooms),bathrooms:parseInt(i.bathrooms)},s=await fetch("/api/properties",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify(e)});if(s.ok)P.success("¡Propiedad creada exitosamente!"),window.location.href="/dashboard";else{const e=await s.text();P.error(e||"Error al crear la propiedad")}}catch(s){P.error("Error al crear la propiedad")}finally{a(!1)}}else P.error("Por favor, corrige los errores en el formulario")},whileHover:{scale:s?1:1.02},whileTap:{scale:s?1:.98},className:"btn-primary flex items-center disabled:opacity-50 disabled:cursor-not-allowed",children:[s?pe.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}):pe.jsx(r,{className:"w-5 h-5 mr-2"}),s?"Creando...":"Crear Propiedad"]})]}),Object.keys(n).length>0&&pe.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[pe.jsx("h4",{className:"text-red-800 font-semibold mb-2",children:"⚠️ Por favor, corrige los siguientes errores:"}),pe.jsx("ul",{className:"text-red-700 text-sm space-y-1",children:Object.entries(n).map((([e,s])=>pe.jsxs("li",{children:["• ",s]},e)))})]})]})}),pe.jsxs(t.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8,delay:.4},className:"mt-8 p-6 bg-primary-50 rounded-xl",children:[pe.jsx("h4",{className:"text-lg font-semibold text-primary-800 mb-3",children:"💡 Consejos para una buena publicación"}),pe.jsxs("ul",{className:"text-primary-700 space-y-2 text-sm",children:[pe.jsx("li",{children:"• Usa un título descriptivo y atractivo (mínimo 5 caracteres)"}),pe.jsx("li",{children:"• Escribe una descripción detallada (mínimo 20 caracteres)"}),pe.jsx("li",{children:"• Puedes agregar imágenes usando URLs de servicios como Imgur"}),pe.jsx("li",{children:"• El precio máximo permitido es €5,000,000"}),pe.jsx("li",{children:"• Habitaciones y baños: entre 1 y 100 (números enteros)"}),pe.jsx("li",{children:"• Verifica que la dirección y ciudad sean correctas"}),pe.jsx("li",{children:"• Los campos marcados con * son obligatorios"})]})]})]})})},ke=()=>{const[s,a]=e.useState(null),[l,n]=e.useState([]),[o,d]=e.useState([]),[m,x]=e.useState("my-requests"),[p,u]=e.useState(!0),[g,y]=e.useState("");e.useEffect((()=>{const e=localStorage.getItem("user");e&&a(JSON.parse(e)),j()}),[]);const j=async()=>{try{const e=localStorage.getItem("token"),s=await fetch("/api/rentals/my-requests",{headers:{Authorization:`Bearer ${e}`}});if(s.ok){const e=await s.json();n(e)}const a=await fetch("/api/rentals/property-requests",{headers:{Authorization:`Bearer ${e}`}});if(a.ok){const e=await a.json();d(e)}}catch(e){b("Error al cargar los alquileres","error")}finally{u(!1)}},b=(e,s="success")=>{y(e),setTimeout((()=>y("")),4e3)},N=e=>{switch(e){case"APPROVED":return pe.jsx(U,{className:"w-5 h-5 text-green-500"});case"REJECTED":return pe.jsx(W,{className:"w-5 h-5 text-red-500"});case"PENDING":return pe.jsx($,{className:"w-5 h-5 text-yellow-500"});default:return pe.jsx(_,{className:"w-5 h-5 text-gray-500"})}},f=e=>{switch(e){case"APPROVED":return"bg-green-100 text-green-800";case"REJECTED":return"bg-red-100 text-red-800";case"PENDING":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},v=e=>{switch(e){case"APPROVED":return"Aprobada";case"REJECTED":return"Rechazada";case"PENDING":return"Pendiente";default:return e}},w=e=>new Date(e).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"});return p?pe.jsx("div",{className:"min-h-screen flex items-center justify-center",children:pe.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-500"})}):pe.jsxs("div",{className:"min-h-screen pt-20 px-4",children:[g&&pe.jsx("div",{className:"fixed top-8 left-1/2 transform -translate-x-1/2 z-50",children:pe.jsx("div",{className:"shadow-lg rounded-xl p-4 border-l-4 max-w-md "+(g.includes("Error")?"bg-red-50 border-red-500":"bg-green-50 border-green-500"),children:pe.jsx("p",{className:g.includes("Error")?"text-red-800":"text-green-800",children:g})})}),pe.jsxs("div",{className:"max-w-7xl mx-auto",children:[pe.jsxs(t.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8},className:"text-center mb-12",children:[pe.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-primary-500 to-secondary-500 rounded-2xl flex items-center justify-center mx-auto mb-4",children:pe.jsx(c,{className:"w-8 h-8 text-white"})}),pe.jsx("h1",{className:"text-4xl font-bold text-gray-800 mb-4",children:"Gestión de Alquileres"}),pe.jsx("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto",children:"Administra tus solicitudes de alquiler y las peticiones para tus propiedades"})]}),pe.jsx(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},className:"flex justify-center mb-8",children:pe.jsxs("div",{className:"flex bg-gray-100 rounded-xl p-1",children:[pe.jsxs("button",{onClick:()=>x("my-requests"),className:"px-6 py-3 rounded-lg transition-all duration-300 "+("my-requests"===m?"bg-white text-primary-600 shadow-md":"text-gray-600 hover:text-gray-800"),children:["Mis Solicitudes (",l.length,")"]}),pe.jsxs("button",{onClick:()=>x("property-requests"),className:"px-6 py-3 rounded-lg transition-all duration-300 "+("property-requests"===m?"bg-white text-primary-600 shadow-md":"text-gray-600 hover:text-gray-800"),children:["Solicitudes Recibidas (",o.length,")"]})]})}),pe.jsx(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.4},children:"my-requests"===m?pe.jsx("div",{className:"space-y-6",children:0===l.length?pe.jsxs("div",{className:"text-center py-20",children:[pe.jsx("div",{className:"w-24 h-24 bg-gray-200 rounded-full flex items-center justify-center mx-auto mb-6",children:pe.jsx(c,{className:"w-12 h-12 text-gray-400"})}),pe.jsx("h3",{className:"text-2xl font-semibold text-gray-800 mb-2",children:"No hay solicitudes enviadas"}),pe.jsx("p",{className:"text-gray-600 mb-6",children:"Aún no has enviado ninguna solicitud de alquiler"}),pe.jsx("button",{onClick:()=>window.location.href="/properties",className:"btn-primary",children:"Explorar Propiedades"})]}):l.map(((e,s)=>pe.jsx(t.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8,delay:.1*s},className:"card p-6",children:pe.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0",children:[pe.jsxs("div",{className:"flex-1 space-y-3",children:[pe.jsxs("div",{className:"flex items-start justify-between",children:[pe.jsxs("div",{children:[pe.jsxs("h3",{className:"text-xl font-semibold text-gray-800 flex items-center",children:[pe.jsx(r,{className:"w-5 h-5 mr-2"}),e.propertyTitle]}),pe.jsxs("p",{className:"text-gray-600 mt-1",children:["Solicitud enviada el ",w(e.createdAt)]})]}),pe.jsxs("span",{className:`flex items-center px-3 py-1 rounded-full text-sm font-medium ${f(e.status)}`,children:[N(e.status),pe.jsx("span",{className:"ml-2",children:v(e.status)})]})]}),pe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[pe.jsxs("div",{className:"flex items-center text-gray-600",children:[pe.jsx(A,{className:"w-4 h-4 mr-2"}),pe.jsxs("div",{children:[pe.jsx("span",{className:"font-medium",children:"Desde:"})," ",w(e.startDate)]})]}),pe.jsxs("div",{className:"flex items-center text-gray-600",children:[pe.jsx(A,{className:"w-4 h-4 mr-2"}),pe.jsxs("div",{children:[pe.jsx("span",{className:"font-medium",children:"Hasta:"})," ",w(e.endDate)]})]}),pe.jsxs("div",{className:"flex items-center text-gray-600",children:[pe.jsx(O,{className:"w-4 h-4 mr-2"}),pe.jsxs("div",{children:[pe.jsx("span",{className:"font-medium",children:"Propuesta:"})," €",e.monthlyRent,"/mes"]})]})]}),e.requestMessage&&pe.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[pe.jsx("p",{className:"text-sm text-gray-600 font-medium mb-1",children:"Tu mensaje:"}),pe.jsx("p",{className:"text-gray-700",children:e.requestMessage})]}),e.responseMessage&&pe.jsxs("div",{className:"p-3 rounded-lg "+("APPROVED"===e.status?"bg-green-50":"bg-red-50"),children:[pe.jsx("p",{className:"text-sm font-medium mb-1 "+("APPROVED"===e.status?"text-green-600":"text-red-600"),children:"Respuesta del propietario:"}),pe.jsx("p",{className:"APPROVED"===e.status?"text-green-700":"text-red-700",children:e.responseMessage})]})]}),pe.jsxs("div",{className:"flex items-center space-x-3",children:["PENDING"===e.status&&pe.jsx("button",{onClick:()=>(async e=>{if(window.confirm("¿Estás seguro de que quieres eliminar esta solicitud?"))try{const s=localStorage.getItem("token");(await fetch(`/api/rentals/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}})).ok?(b("Solicitud eliminada exitosamente"),j()):b("Error al eliminar la solicitud","error")}catch(s){b("Error al eliminar la solicitud","error")}})(e.id),className:"px-4 py-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 transition-colors duration-300",children:"Cancelar"}),pe.jsx("button",{onClick:()=>window.location.href=`/properties/${e.propertyId}`,className:"px-4 py-2 bg-primary-100 text-primary-600 rounded-lg hover:bg-primary-200 transition-colors duration-300",children:"Ver Propiedad"})]})]})},e.id)))}):pe.jsx("div",{className:"space-y-6",children:0===o.length?pe.jsxs("div",{className:"text-center py-20",children:[pe.jsx("div",{className:"w-24 h-24 bg-gray-200 rounded-full flex items-center justify-center mx-auto mb-6",children:pe.jsx(J,{className:"w-12 h-12 text-gray-400"})}),pe.jsx("h3",{className:"text-2xl font-semibold text-gray-800 mb-2",children:"No hay solicitudes recibidas"}),pe.jsx("p",{className:"text-gray-600 mb-6",children:"Aún no has recibido solicitudes para tus propiedades"}),pe.jsx("button",{onClick:()=>window.location.href="/create-property",className:"btn-primary",children:"Publicar Propiedad"})]}):o.map(((e,s)=>pe.jsx(t.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8,delay:.1*s},className:"card p-6",children:pe.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0",children:[pe.jsxs("div",{className:"flex-1 space-y-3",children:[pe.jsxs("div",{className:"flex items-start justify-between",children:[pe.jsxs("div",{children:[pe.jsxs("h3",{className:"text-xl font-semibold text-gray-800 flex items-center",children:[pe.jsx(r,{className:"w-5 h-5 mr-2"}),e.propertyTitle]}),pe.jsxs("div",{className:"flex items-center mt-1 text-gray-600",children:[pe.jsx(i,{className:"w-4 h-4 mr-1"}),pe.jsxs("span",{children:["Solicitante: ",e.tenantUsername]})]}),pe.jsxs("p",{className:"text-gray-600 text-sm",children:["Solicitud recibida el ",w(e.createdAt)]})]}),pe.jsxs("span",{className:`flex items-center px-3 py-1 rounded-full text-sm font-medium ${f(e.status)}`,children:[N(e.status),pe.jsx("span",{className:"ml-2",children:v(e.status)})]})]}),pe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[pe.jsxs("div",{className:"flex items-center text-gray-600",children:[pe.jsx(A,{className:"w-4 h-4 mr-2"}),pe.jsxs("div",{children:[pe.jsx("span",{className:"font-medium",children:"Desde:"})," ",w(e.startDate)]})]}),pe.jsxs("div",{className:"flex items-center text-gray-600",children:[pe.jsx(A,{className:"w-4 h-4 mr-2"}),pe.jsxs("div",{children:[pe.jsx("span",{className:"font-medium",children:"Hasta:"})," ",w(e.endDate)]})]}),pe.jsxs("div",{className:"flex items-center text-gray-600",children:[pe.jsx(O,{className:"w-4 h-4 mr-2"}),pe.jsxs("div",{children:[pe.jsx("span",{className:"font-medium",children:"Propuesta:"})," €",e.monthlyRent,"/mes"]})]})]}),e.requestMessage&&pe.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[pe.jsx("p",{className:"text-sm text-blue-600 font-medium mb-1",children:"Mensaje del solicitante:"}),pe.jsx("p",{className:"text-blue-700",children:e.requestMessage})]}),e.responseMessage&&pe.jsxs("div",{className:"p-3 rounded-lg "+("APPROVED"===e.status?"bg-green-50":"bg-red-50"),children:[pe.jsx("p",{className:"text-sm font-medium mb-1 "+("APPROVED"===e.status?"text-green-600":"text-red-600"),children:"Tu respuesta:"}),pe.jsx("p",{className:"APPROVED"===e.status?"text-green-700":"text-red-700",children:e.responseMessage})]})]}),pe.jsxs("div",{className:"flex items-center space-x-3",children:["PENDING"===e.status&&pe.jsxs(pe.Fragment,{children:[pe.jsxs("button",{onClick:()=>(async e=>{const s=prompt("Motivo del rechazo (opcional):");try{const a=localStorage.getItem("token");(await fetch(`/api/rentals/${e}/reject?message=${encodeURIComponent(s||"")}`,{method:"POST",headers:{Authorization:`Bearer ${a}`}})).ok?(b("Solicitud rechazada"),j()):b("Error al rechazar la solicitud","error")}catch(a){b("Error al rechazar la solicitud","error")}})(e.id),className:"px-4 py-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 transition-colors duration-300 flex items-center",children:[pe.jsx(h,{className:"w-4 h-4 mr-1"}),"Rechazar"]}),pe.jsxs("button",{onClick:()=>(async e=>{const s=prompt("Mensaje de respuesta (opcional):");try{const a=localStorage.getItem("token");(await fetch(`/api/rentals/${e}/approve?message=${encodeURIComponent(s||"")}`,{method:"POST",headers:{Authorization:`Bearer ${a}`}})).ok?(b("Solicitud aprobada exitosamente"),j()):b("Error al aprobar la solicitud","error")}catch(a){b("Error al aprobar la solicitud","error")}})(e.id),className:"px-4 py-2 bg-green-100 text-green-600 rounded-lg hover:bg-green-200 transition-colors duration-300 flex items-center",children:[pe.jsx(Z,{className:"w-4 h-4 mr-1"}),"Aprobar"]})]}),pe.jsx("button",{onClick:()=>window.location.href=`/properties/${e.propertyId}`,className:"px-4 py-2 bg-primary-100 text-primary-600 rounded-lg hover:bg-primary-200 transition-colors duration-300",children:"Ver Propiedad"})]})]})},e.id)))})})]})]})},Ee=()=>{const[s,a]=e.useState(null),[l,n]=e.useState(null),[o,d]=e.useState(!1),[m,x]=e.useState(0),[h,p]=e.useState({startDate:"",endDate:"",monthlyRent:"",requestMessage:""});e.useEffect((()=>{const e=window.location.pathname.split("/"),s=e[e.length-1],a=localStorage.getItem("user");a&&n(JSON.parse(a)),u(s)}),[]);const u=async e=>{try{const s=await fetch(`/api/properties/${e}`);if(s.ok){const e=await s.json();a(e),p((s=>({...s,monthlyRent:e.price})))}else P.error("Error al cargar la propiedad"),window.location.href="/properties"}catch(s){P.error("Error al cargar la propiedad"),window.location.href="/properties"}},g=e=>{p({...h,[e.target.name]:e.target.value})},y=()=>{if(!h.startDate||!h.endDate)return!0;const e=new Date(h.startDate),s=new Date(h.endDate),a=new Date;return a.setHours(0,0,0,0),e>=a&&s>e},j=()=>(new Date).toISOString().split("T")[0];return s&&l?l.username===s.ownerUsername?pe.jsx("div",{className:"min-h-screen flex items-center justify-center",children:pe.jsxs("div",{className:"text-center",children:[pe.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"No puedes solicitar el alquiler de tu propia propiedad"}),pe.jsx("button",{onClick:()=>window.location.href="/properties",className:"btn-primary",children:"Buscar Otras Propiedades"})]})}):pe.jsx("div",{className:"min-h-screen pt-20 px-4",children:pe.jsxs("div",{className:"max-w-4xl mx-auto",children:[pe.jsxs(t.button,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5},onClick:()=>window.history.back(),className:"flex items-center text-gray-600 hover:text-primary-600 transition-colors duration-300 mb-8",children:[pe.jsx(F,{className:"w-5 h-5 mr-2"}),"Volver"]}),pe.jsxs(t.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8},className:"text-center mb-12",children:[pe.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-primary-500 to-secondary-500 rounded-2xl flex items-center justify-center mx-auto mb-4",children:pe.jsx(c,{className:"w-8 h-8 text-white"})}),pe.jsx("h1",{className:"text-4xl font-bold text-gray-800 mb-4",children:"Solicitar Alquiler"}),pe.jsx("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto",children:"Envía una solicitud al propietario para alquilar esta propiedad"})]}),pe.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[pe.jsxs(t.div,{initial:{opacity:0,x:-30},animate:{opacity:1,x:0},transition:{duration:.8,delay:.2},className:"card p-6",children:[pe.jsxs("h3",{className:"text-2xl font-semibold text-gray-800 mb-6 flex items-center",children:[pe.jsx(r,{className:"w-6 h-6 mr-2"}),"Detalles de la Propiedad"]}),pe.jsxs("div",{className:"space-y-4",children:[pe.jsxs("div",{className:"relative overflow-hidden rounded-xl mb-4",children:[s.images&&s.images.length>0?pe.jsxs("div",{className:"relative h-48 group",children:[pe.jsx("img",{src:s.images[m],alt:s.title,className:"w-full h-full object-cover",onError:e=>{e.target.style.display="none",e.target.nextSibling.style.display="flex"}}),pe.jsx("div",{className:"h-48 bg-gradient-to-br from-primary-400 to-secondary-400 flex items-center justify-center",style:{display:"none"},children:pe.jsx("span",{className:"text-white text-6xl font-bold",children:s.title.charAt(0)})}),s.images.length>1&&pe.jsxs(pe.Fragment,{children:[pe.jsx("button",{onClick:()=>{s.images&&s.images.length>1&&x((e=>(e-1+s.images.length)%s.images.length))},className:"absolute left-2 top-1/2 transform -translate-y-1/2 bg-black/50 text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:pe.jsx(I,{className:"w-4 h-4"})}),pe.jsx("button",{onClick:()=>{s.images&&s.images.length>1&&x((e=>(e+1)%s.images.length))},className:"absolute right-2 top-1/2 transform -translate-y-1/2 bg-black/50 text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:pe.jsx(D,{className:"w-4 h-4"})}),pe.jsx("div",{className:"absolute bottom-2 left-1/2 transform -translate-x-1/2 flex space-x-1",children:s.images.map(((e,s)=>pe.jsx("div",{className:"w-2 h-2 rounded-full transition-colors duration-300 "+(s===m?"bg-white":"bg-white/50")},s)))})]})]}):pe.jsx("div",{className:"h-48 bg-gradient-to-br from-primary-400 to-secondary-400 flex items-center justify-center",children:pe.jsx("span",{className:"text-white text-6xl font-bold",children:s.title.charAt(0)})}),pe.jsx("div",{className:"absolute top-3 right-3",children:s.available?pe.jsx("div",{className:"bg-green-500 text-white px-3 py-1 rounded-full text-sm font-semibold",children:"Disponible"}):pe.jsxs("div",{className:"flex flex-col space-y-1",children:[pe.jsx("div",{className:"bg-red-500 text-white px-3 py-1 rounded-full text-sm font-semibold",children:"Ocupado"}),s.occupiedUntil&&pe.jsxs("div",{className:"bg-orange-500 text-white px-2 py-1 rounded-full text-xs font-semibold",children:["Hasta: ",(b=s.occupiedUntil,b?new Date(b).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}):null)]})]})})]}),pe.jsxs("div",{children:[pe.jsx("h4",{className:"text-xl font-semibold text-gray-800 mb-2",children:s.title}),pe.jsx("p",{className:"text-gray-600 mb-4",children:s.description})]}),pe.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[pe.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[pe.jsx("span",{className:"text-gray-600",children:"Dirección:"}),pe.jsx("p",{className:"font-medium text-gray-800",children:s.address})]}),pe.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[pe.jsx("span",{className:"text-gray-600",children:"Ciudad:"}),pe.jsx("p",{className:"font-medium text-gray-800",children:s.city})]}),pe.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[pe.jsx("span",{className:"text-gray-600",children:"Habitaciones:"}),pe.jsx("p",{className:"font-medium text-gray-800",children:s.bedrooms})]}),pe.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[pe.jsx("span",{className:"text-gray-600",children:"Baños:"}),pe.jsx("p",{className:"font-medium text-gray-800",children:s.bathrooms})]})]}),pe.jsxs("div",{className:"bg-primary-50 p-4 rounded-lg",children:[pe.jsxs("div",{className:"flex items-center text-primary-600 mb-2",children:[pe.jsx(i,{className:"w-5 h-5 mr-2"}),pe.jsx("span",{className:"font-medium",children:"Propietario"})]}),pe.jsx("p",{className:"text-primary-800 font-semibold",children:s.ownerUsername})]}),pe.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[pe.jsxs("div",{className:"flex items-center text-green-600 mb-2",children:[pe.jsx(O,{className:"w-5 h-5 mr-2"}),pe.jsx("span",{className:"font-medium",children:"Precio sugerido"})]}),pe.jsxs("p",{className:"text-2xl font-bold text-green-800",children:["€",s.price,"/mes"]})]})]})]}),pe.jsxs(t.div,{initial:{opacity:0,x:30},animate:{opacity:1,x:0},transition:{duration:.8,delay:.4},className:"card p-6",children:[pe.jsxs("h3",{className:"text-2xl font-semibold text-gray-800 mb-6 flex items-center",children:[pe.jsx(A,{className:"w-6 h-6 mr-2"}),"Solicitud de Alquiler"]}),pe.jsxs("div",{className:"space-y-6",children:[pe.jsxs("div",{children:[pe.jsx("label",{htmlFor:"startDate",className:"block text-sm font-medium text-gray-700 mb-2",children:"Fecha de Inicio Deseada"}),pe.jsx("input",{type:"date",id:"startDate",name:"startDate",value:h.startDate,onChange:g,min:j(),className:"input-field",required:!0})]}),pe.jsxs("div",{children:[pe.jsx("label",{htmlFor:"endDate",className:"block text-sm font-medium text-gray-700 mb-2",children:"Fecha de Fin Deseada"}),pe.jsx("input",{type:"date",id:"endDate",name:"endDate",value:h.endDate,onChange:g,min:(()=>{if(!h.startDate)return j();const e=new Date(h.startDate);return e.setDate(e.getDate()+1),e.toISOString().split("T")[0]})(),className:"input-field",required:!0})]}),pe.jsxs("div",{children:[pe.jsx("label",{htmlFor:"monthlyRent",className:"block text-sm font-medium text-gray-700 mb-2",children:"Propuesta de Renta Mensual (€)"}),pe.jsxs("div",{className:"relative",children:[pe.jsx(O,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),pe.jsx("input",{type:"number",id:"monthlyRent",name:"monthlyRent",value:h.monthlyRent,onChange:g,className:"input-field pl-12",min:"0",step:"0.01",required:!0})]}),pe.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Precio sugerido: €",s.price]})]}),pe.jsxs("div",{children:[pe.jsx("label",{htmlFor:"requestMessage",className:"block text-sm font-medium text-gray-700 mb-2",children:"Mensaje para el Propietario"}),pe.jsxs("div",{className:"relative",children:[pe.jsx(J,{className:"absolute left-3 top-3 text-gray-400 w-5 h-5"}),pe.jsx("textarea",{id:"requestMessage",name:"requestMessage",value:h.requestMessage,onChange:g,rows:4,className:"input-field pl-12 resize-none",placeholder:"Preséntate y explica por qué eres el inquilino ideal para esta propiedad...",required:!0})]})]}),h.startDate&&h.endDate&&h.monthlyRent&&pe.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[pe.jsx("h4",{className:"font-semibold text-blue-800 mb-3",children:"Resumen de la Solicitud"}),pe.jsxs("div",{className:"space-y-2 text-sm text-blue-700",children:[pe.jsxs("div",{className:"flex justify-between",children:[pe.jsx("span",{children:"Solicitante:"}),pe.jsx("span",{className:"font-medium",children:l.username})]}),pe.jsxs("div",{className:"flex justify-between",children:[pe.jsx("span",{children:"Duración:"}),pe.jsxs("span",{className:"font-medium",children:[Math.ceil((new Date(h.endDate)-new Date(h.startDate))/864e5)," días"]})]}),pe.jsxs("div",{className:"flex justify-between",children:[pe.jsx("span",{children:"Renta propuesta:"}),pe.jsxs("span",{className:"font-medium",children:["€",h.monthlyRent,"/mes"]})]}),pe.jsxs("div",{className:"flex justify-between",children:[pe.jsx("span",{children:"Estado:"}),pe.jsx("span",{className:"font-medium",children:s.available?"Solicitud inmediata":"Solicitud futura"})]})]})]}),!y()&&pe.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:pe.jsx("p",{className:"text-red-700 text-sm",children:"⚠️ Las fechas no son válidas. La fecha de inicio debe ser hoy o posterior, y la fecha de fin debe ser posterior a la de inicio."})}),pe.jsxs("div",{className:"flex items-center justify-end space-x-4 pt-6 border-t border-gray-200",children:[pe.jsx("button",{type:"button",onClick:()=>window.history.back(),className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors duration-300",children:"Cancelar"}),pe.jsxs(t.button,{type:"submit",disabled:o||!y()||!h.requestMessage.trim(),onClick:async e=>{e.preventDefault(),d(!0);const a={propertyId:parseInt(s.id),tenantId:l.id,...h,monthlyRent:parseFloat(h.monthlyRent)};try{const e=await fetch("/api/rentals",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify(a)});if(e.ok)P.success("¡Solicitud de alquiler enviada exitosamente!"),window.location.href="/rentals";else{const s=await e.text();P.error(s||"Error al enviar la solicitud")}}catch(t){P.error("Error al enviar la solicitud")}finally{d(!1)}},whileHover:{scale:o?1:1.02},whileTap:{scale:o?1:.98},className:"btn-primary flex items-center disabled:opacity-50 disabled:cursor-not-allowed",children:[o?pe.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}):pe.jsx(c,{className:"w-5 h-5 mr-2"}),o?"Enviando...":"Enviar Solicitud"]})]})]})]})]}),pe.jsxs(t.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8,delay:.6},className:"mt-8 p-6 bg-yellow-50 border border-yellow-200 rounded-xl",children:[pe.jsx("h4",{className:"text-lg font-semibold text-yellow-800 mb-3",children:"📋 Información sobre el Proceso"}),pe.jsxs("ul",{className:"text-yellow-700 space-y-2 text-sm",children:[pe.jsx("li",{children:"• Tu solicitud será enviada al propietario para su revisión"}),pe.jsx("li",{children:"• El propietario podrá aceptar, rechazar o negociar tu propuesta"}),pe.jsx("li",{children:"• Recibirás una notificación con la respuesta del propietario"}),pe.jsx("li",{children:"• Puedes hacer múltiples solicitudes para diferentes propiedades"}),pe.jsxs("li",{children:["• ",s.available?"Esta propiedad está disponible inmediatamente":"Esta propiedad está ocupada, tu solicitud será para cuando se libere"]})]})]})]})}):pe.jsx("div",{className:"min-h-screen flex items-center justify-center",children:pe.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-500"})});var b},Pe=re.create({baseURL:"",headers:{"Content-Type":"application/json"}});Pe.interceptors.request.use((e=>{const s=localStorage.getItem("token");return s&&(e.headers.Authorization=`Bearer ${s}`),e})),Pe.interceptors.response.use((e=>e),(e=>{var s;return 401!==(null==(s=e.response)?void 0:s.status)||window.location.pathname.includes("/login")||window.location.pathname.includes("/register")||(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(e)}));const Ie=()=>{const[s,a]=e.useState("overview"),[l,n]=e.useState([]),[c,d]=e.useState([]),[x,h]=e.useState([]),[p,g]=e.useState(!1),[y,f]=e.useState([]),[v,w]=e.useState([]),[C,k]=e.useState(""),[E,I]=e.useState("");e.useEffect((()=>{D()}),[]);const D=async()=>{g(!0);try{await Promise.all([M(),R(),O()])}catch(e){P.error("Error al cargar datos del sistema")}finally{g(!1)}},M=async()=>{try{const e=await Pe.get("/api/admin/users");n(e.data)}catch(e){console.error("Error fetching users:",e)}},R=async()=>{try{const e=await Pe.get("/api/properties");d(e.data)}catch(e){console.error("Error fetching properties:",e)}},O=async()=>{try{const e=await Pe.get("/api/rentals");h(e.data)}catch(e){console.error("Error fetching rentals:",e)}},T=async()=>{if(0!==y.length){if(window.confirm(`¿Eliminar ${y.length} propiedades del sistema?`))try{await Promise.all(y.map((e=>Pe.delete(`/api/properties/${e}`)))),P.success(`${y.length} propiedades eliminadas del sistema`),f([]),R(),O()}catch(e){P.error("Error al eliminar propiedades")}}else P.error("Selecciona al menos una propiedad")},q=async()=>{if(0===v.length)return void P.error("Selecciona al menos un usuario");if(v.some((e=>{const s=l.find((s=>s.id===e));return"ADMIN"===(null==s?void 0:s.role)})))P.error("No se pueden eliminar usuarios administradores");else if(window.confirm(`¿Eliminar ${v.length} usuarios del sistema?`))try{await Promise.all(v.map((e=>Pe.delete(`/api/admin/users/${e}`)))),P.success(`${v.length} usuarios eliminados del sistema`),w([]),M(),R()}catch(e){P.error("Error al eliminar usuarios")}},L=async()=>{if(window.confirm("¿Limpiar automáticamente todas las solicitudes vencidas del sistema?"))try{await Pe.post("/api/rentals/finalize-expired"),P.success("Solicitudes vencidas limpiadas del sistema"),O(),R()}catch(e){P.error("Error al limpiar solicitudes vencidas")}},F=()=>{f((e=>e.length===c.length?[]:c.map((e=>e.id))))},$=()=>{const e=l.filter((e=>"ADMIN"!==e.role));w((s=>s.length===e.length?[]:e.map((e=>e.id))))},z=c.reduce(((e,s)=>e+parseFloat(s.price||0)),0),H=c.length>0?z/c.length:0,G=c.filter((e=>e.available)).length,V=c.length>0?(c.length-G)/c.length*100:0,J=x.filter((e=>"PENDING"===e.status)).length,Z=x.filter((e=>"APPROVED"===e.status)).length,_=l.filter((e=>"ADMIN"===e.role)).length,W=l.filter((e=>"USER"===e.role)).length,se=c.reduce(((e,s)=>(e[s.city]=(e[s.city]||0)+1,e)),{}),ae=l.filter((e=>e.username.toLowerCase().includes(C.toLowerCase())||e.email.toLowerCase().includes(C.toLowerCase()))),te=c.filter((e=>e.title.toLowerCase().includes(E.toLowerCase())||e.city.toLowerCase().includes(E.toLowerCase())));return p?pe.jsx("div",{className:"min-h-screen flex items-center justify-center",children:pe.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-500"})}):pe.jsx("div",{className:"min-h-screen pt-20 px-4",children:pe.jsxs("div",{className:"max-w-7xl mx-auto",children:[pe.jsxs(t.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8},className:"text-center mb-12",children:[pe.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-red-500 to-red-600 rounded-2xl flex items-center justify-center mx-auto mb-4",children:pe.jsx(Q,{className:"w-8 h-8 text-white"})}),pe.jsx("h1",{className:"text-4xl font-bold text-gray-800 mb-4",children:"Panel de Control del Sistema"}),pe.jsx("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto",children:"Supervisión y mantenimiento de la plataforma RentMeNow"})]}),pe.jsx("div",{className:"flex justify-center mb-8",children:pe.jsxs("div",{className:"flex bg-gray-100 rounded-xl p-1",children:[pe.jsxs("button",{onClick:()=>a("overview"),className:"px-6 py-3 rounded-lg transition-all duration-300 "+("overview"===s?"bg-white text-primary-600 shadow-md":"text-gray-600 hover:text-gray-800"),children:[pe.jsx(o,{className:"w-5 h-5 mr-2 inline"}),"Sistema"]}),pe.jsxs("button",{onClick:()=>a("users"),className:"px-6 py-3 rounded-lg transition-all duration-300 "+("users"===s?"bg-white text-primary-600 shadow-md":"text-gray-600 hover:text-gray-800"),children:[pe.jsx(Q,{className:"w-5 h-5 mr-2 inline"}),"Usuarios (",l.length,")"]}),pe.jsxs("button",{onClick:()=>a("properties"),className:"px-6 py-3 rounded-lg transition-all duration-300 "+("properties"===s?"bg-white text-primary-600 shadow-md":"text-gray-600 hover:text-gray-800"),children:[pe.jsx(Y,{className:"w-5 h-5 mr-2 inline"}),"Propiedades (",c.length,")"]})]})}),pe.jsxs(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},children:["overview"===s&&pe.jsxs("div",{className:"space-y-8",children:[pe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[pe.jsxs(t.div,{whileHover:{y:-5},className:"card p-6 text-center",children:[pe.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-xl flex items-center justify-center mx-auto mb-4",children:pe.jsx(N,{className:"w-8 h-8 text-blue-600"})}),pe.jsx("div",{className:"text-3xl font-bold text-gray-800 mb-2",children:l.length}),pe.jsx("div",{className:"text-gray-600",children:"Usuarios Registrados"}),pe.jsxs("div",{className:"text-sm text-gray-500 mt-2",children:[_," Admin • ",W," Usuarios"]})]}),pe.jsxs(t.div,{whileHover:{y:-5},className:"card p-6 text-center",children:[pe.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-xl flex items-center justify-center mx-auto mb-4",children:pe.jsx(r,{className:"w-8 h-8 text-green-600"})}),pe.jsx("div",{className:"text-3xl font-bold text-gray-800 mb-2",children:c.length}),pe.jsx("div",{className:"text-gray-600",children:"Propiedades en Sistema"}),pe.jsxs("div",{className:"text-sm text-gray-500 mt-2",children:[G," Disponibles • ",c.length-G," Ocupadas"]})]}),pe.jsxs(t.div,{whileHover:{y:-5},className:"card p-6 text-center",children:[pe.jsx("div",{className:"w-16 h-16 bg-purple-100 rounded-xl flex items-center justify-center mx-auto mb-4",children:pe.jsx(X,{className:"w-8 h-8 text-purple-600"})}),pe.jsx("div",{className:"text-3xl font-bold text-gray-800 mb-2",children:x.length}),pe.jsx("div",{className:"text-gray-600",children:"Solicitudes Totales"}),pe.jsxs("div",{className:"text-sm text-gray-500 mt-2",children:[J," Pendientes • ",Z," Aprobadas"]})]}),pe.jsxs(t.div,{whileHover:{y:-5},className:"card p-6 text-center",children:[pe.jsx("div",{className:"w-16 h-16 bg-yellow-100 rounded-xl flex items-center justify-center mx-auto mb-4",children:pe.jsx(ee,{className:"w-8 h-8 text-yellow-600"})}),pe.jsxs("div",{className:"text-3xl font-bold text-gray-800 mb-2",children:[V.toFixed(1),"%"]}),pe.jsx("div",{className:"text-gray-600",children:"Tasa de Ocupación"}),pe.jsxs("div",{className:"text-sm text-gray-500 mt-2",children:["€",H.toFixed(0)," renta promedio"]})]})]}),pe.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[pe.jsxs("div",{className:"card p-6",children:[pe.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[pe.jsx(Y,{className:"w-6 h-6 mr-2"}),"Estado del Sistema"]}),pe.jsxs("div",{className:"space-y-4",children:[pe.jsxs("div",{className:"flex justify-between items-center p-3 bg-green-50 rounded-lg",children:[pe.jsx("span",{className:"text-green-700 font-medium",children:"Sistema Operativo"}),pe.jsxs("span",{className:"text-green-800 font-bold flex items-center",children:[pe.jsx(U,{className:"w-4 h-4 mr-1"}),"Activo"]})]}),pe.jsxs("div",{className:"flex justify-between items-center p-3 bg-blue-50 rounded-lg",children:[pe.jsx("span",{className:"text-blue-700 font-medium",children:"Valor Total Propiedades"}),pe.jsxs("span",{className:"text-blue-800 font-bold",children:["€",z.toFixed(0),"/mes"]})]}),pe.jsxs("div",{className:"flex justify-between items-center p-3 bg-purple-50 rounded-lg",children:[pe.jsx("span",{className:"text-purple-700 font-medium",children:"Actividad Pendiente"}),pe.jsxs("span",{className:"text-purple-800 font-bold",children:[J," solicitudes"]})]})]})]}),pe.jsxs("div",{className:"card p-6",children:[pe.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[pe.jsx(j,{className:"w-6 h-6 mr-2"}),"Distribución por Ciudades"]}),pe.jsx("div",{className:"space-y-3",children:Object.entries(se).slice(0,5).map((([e,s])=>pe.jsxs("div",{className:"flex justify-between items-center",children:[pe.jsx("span",{className:"text-gray-700",children:e}),pe.jsxs("span",{className:"bg-primary-100 text-primary-700 px-2 py-1 rounded-full text-sm font-medium",children:[s," propiedades"]})]},e)))})]})]}),pe.jsxs("div",{className:"card p-6",children:[pe.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[pe.jsx(m,{className:"w-6 h-6 mr-2"}),"Mantenimiento del Sistema"]}),pe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[pe.jsxs("button",{onClick:L,className:"p-4 bg-orange-100 text-orange-700 rounded-lg hover:bg-orange-200 transition-colors flex items-center justify-center",children:[pe.jsx(A,{className:"w-5 h-5 mr-2"}),"Limpiar Solicitudes Vencidas"]}),pe.jsxs("button",{onClick:()=>a("properties"),className:"p-4 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors flex items-center justify-center",children:[pe.jsx(B,{className:"w-5 h-5 mr-2"}),"Eliminar Propiedades"]}),pe.jsxs("button",{onClick:()=>a("users"),className:"p-4 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors flex items-center justify-center",children:[pe.jsx(Q,{className:"w-5 h-5 mr-2"}),"Gestionar Usuarios"]})]})]})]}),"users"===s&&pe.jsxs("div",{className:"space-y-6",children:[pe.jsxs("div",{className:"flex justify-between items-center",children:[pe.jsxs("h3",{className:"text-2xl font-semibold text-gray-800 flex items-center",children:[pe.jsx(Q,{className:"w-6 h-6 mr-2"}),"Control de Usuarios (",l.length,")"]}),pe.jsxs("div",{className:"flex items-center space-x-4",children:[pe.jsxs("div",{className:"relative",children:[pe.jsx(b,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),pe.jsx("input",{type:"text",placeholder:"Buscar usuarios...",value:C,onChange:e=>k(e.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),v.length>0&&pe.jsxs("button",{onClick:q,className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors flex items-center",children:[pe.jsx(B,{className:"w-4 h-4 mr-2"}),"Eliminar Seleccionados (",v.length,")"]})]})]}),pe.jsxs("div",{className:"card p-6",children:[pe.jsxs("div",{className:"mb-4 flex items-center",children:[pe.jsx("input",{type:"checkbox",checked:v.length===l.filter((e=>"ADMIN"!==e.role)).length&&l.filter((e=>"ADMIN"!==e.role)).length>0,onChange:$,className:"mr-2"}),pe.jsx("label",{className:"text-sm text-gray-600",children:"Seleccionar todos los usuarios (excepto admins)"})]}),pe.jsx("div",{className:"overflow-x-auto",children:pe.jsxs("table",{className:"min-w-full",children:[pe.jsx("thead",{children:pe.jsxs("tr",{className:"border-b border-gray-200",children:[pe.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Seleccionar"}),pe.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Usuario"}),pe.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Email"}),pe.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Rol"}),pe.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Estado"}),pe.jsx("th",{className:"text-center py-3 px-4 font-semibold text-gray-700",children:"Acciones"})]})}),pe.jsx("tbody",{children:ae.map((e=>pe.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[pe.jsx("td",{className:"py-3 px-4",children:pe.jsx("input",{type:"checkbox",checked:v.includes(e.id),onChange:()=>{return s=e.id,void w((e=>e.includes(s)?e.filter((e=>e!==s)):[...e,s]));var s},disabled:"ADMIN"===e.role})}),pe.jsx("td",{className:"py-3 px-4",children:pe.jsxs("div",{className:"flex items-center",children:[pe.jsx("div",{className:"w-10 h-10 bg-primary-100 rounded-full flex items-center justify-center mr-3",children:pe.jsx(i,{className:"w-5 h-5 text-primary-600"})}),pe.jsxs("div",{children:[pe.jsx("div",{className:"font-medium text-gray-800",children:e.username}),pe.jsxs("div",{className:"text-sm text-gray-500",children:[e.firstName," ",e.lastName]})]})]})}),pe.jsx("td",{className:"py-3 px-4 text-gray-600",children:e.email}),pe.jsx("td",{className:"py-3 px-4",children:pe.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+("ADMIN"===e.role?"bg-red-100 text-red-800":"bg-green-100 text-green-800"),children:"ADMIN"===e.role?"Administrador":"Usuario"})}),pe.jsx("td",{className:"py-3 px-4",children:pe.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Activo"})}),pe.jsx("td",{className:"py-3 px-4 text-center",children:pe.jsx("button",{onClick:()=>(async e=>{const s=l.find((s=>s.id===e));if("ADMIN"!==(null==s?void 0:s.role)){if(window.confirm("¿Estás seguro de eliminar este usuario? Esta acción eliminará también todas sus propiedades y solicitudes."))try{await Pe.delete(`/api/admin/users/${e}`),P.success("Usuario eliminado del sistema"),M(),R()}catch(a){P.error("Error al eliminar usuario")}}else P.error("No se puede eliminar un usuario administrador")})(e.id),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors",disabled:"ADMIN"===e.role,title:"ADMIN"===e.role?"No se puede eliminar un administrador":"Eliminar usuario",children:pe.jsx(B,{className:"w-4 h-4"})})})]},e.id)))})]})})]})]}),"properties"===s&&pe.jsxs("div",{className:"space-y-6",children:[pe.jsxs("div",{className:"flex justify-between items-center",children:[pe.jsxs("h3",{className:"text-2xl font-semibold text-gray-800 flex items-center",children:[pe.jsx(Y,{className:"w-6 h-6 mr-2"}),"Control de Propiedades (",c.length,")"]}),pe.jsxs("div",{className:"flex items-center space-x-4",children:[pe.jsxs("div",{className:"relative",children:[pe.jsx(b,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),pe.jsx("input",{type:"text",placeholder:"Buscar propiedades...",value:E,onChange:e=>I(e.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),y.length>0&&pe.jsxs("button",{onClick:T,className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors flex items-center",children:[pe.jsx(B,{className:"w-4 h-4 mr-2"}),"Eliminar Seleccionadas (",y.length,")"]})]})]}),pe.jsxs("div",{className:"card p-6",children:[pe.jsxs("div",{className:"mb-4 flex items-center",children:[pe.jsx("input",{type:"checkbox",checked:y.length===c.length&&c.length>0,onChange:F,className:"mr-2"}),pe.jsx("label",{className:"text-sm text-gray-600",children:"Seleccionar todas las propiedades"})]}),pe.jsx("div",{className:"overflow-x-auto",children:pe.jsxs("table",{className:"min-w-full",children:[pe.jsx("thead",{children:pe.jsxs("tr",{className:"border-b border-gray-200",children:[pe.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Seleccionar"}),pe.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Propiedad"}),pe.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Propietario"}),pe.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Ubicación"}),pe.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Estado"}),pe.jsx("th",{className:"text-center py-3 px-4 font-semibold text-gray-700",children:"Acciones"})]})}),pe.jsx("tbody",{children:te.map((e=>pe.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[pe.jsx("td",{className:"py-3 px-4",children:pe.jsx("input",{type:"checkbox",checked:y.includes(e.id),onChange:()=>{return s=e.id,void f((e=>e.includes(s)?e.filter((e=>e!==s)):[...e,s]));var s}})}),pe.jsx("td",{className:"py-3 px-4",children:pe.jsxs("div",{className:"flex items-center",children:[pe.jsx("div",{className:"w-16 h-12 bg-gradient-to-r from-primary-400 to-secondary-400 rounded-lg flex items-center justify-center mr-3",children:pe.jsx(u,{className:"w-6 h-6 text-white"})}),pe.jsxs("div",{children:[pe.jsx("div",{className:"font-medium text-gray-800",children:e.title}),pe.jsxs("div",{className:"text-sm text-gray-500",children:["€",e.price,"/mes • ",e.bedrooms," hab • ",e.bathrooms," baños"]})]})]})}),pe.jsx("td",{className:"py-3 px-4 text-gray-600",children:e.ownerUsername}),pe.jsx("td",{className:"py-3 px-4",children:pe.jsxs("div",{className:"flex items-center text-gray-600",children:[pe.jsx(j,{className:"w-4 h-4 mr-1"}),e.city]})}),pe.jsx("td",{className:"py-3 px-4",children:pe.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+(e.available?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.available?"Disponible":"Ocupada"})}),pe.jsx("td",{className:"py-3 px-4 text-center",children:pe.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[pe.jsx("button",{onClick:()=>window.open(`/properties/${e.id}`,"_blank"),className:"p-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors",title:"Ver propiedad",children:pe.jsx(S,{className:"w-4 h-4"})}),pe.jsx("button",{onClick:()=>(async e=>{if(window.confirm("¿Eliminar esta propiedad del sistema? Se cancelarán todas las solicitudes asociadas."))try{await Pe.delete(`/api/properties/${e}`),P.success("Propiedad eliminada del sistema"),R(),O()}catch(s){P.error("Error al eliminar propiedad")}})(e.id),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors",title:"Eliminar del sistema",children:pe.jsx(B,{className:"w-4 h-4"})})]})})]},e.id)))})]})})]})]})]}),(y.length>0||v.length>0)&&pe.jsx("div",{className:"fixed bottom-6 right-6 bg-red-600 text-white p-4 rounded-xl shadow-lg",children:pe.jsxs("div",{className:"flex items-center space-x-4",children:[y.length>0&&pe.jsxs(pe.Fragment,{children:[pe.jsxs("span",{children:[y.length," propiedades seleccionadas"]}),pe.jsx("button",{onClick:T,className:"bg-red-700 hover:bg-red-800 px-3 py-1 rounded-lg transition-colors",children:pe.jsx(B,{className:"w-4 h-4"})})]}),v.length>0&&pe.jsxs(pe.Fragment,{children:[pe.jsxs("span",{children:[v.length," usuarios seleccionados"]}),pe.jsx("button",{onClick:q,className:"bg-red-700 hover:bg-red-800 px-3 py-1 rounded-lg transition-colors",children:pe.jsx(B,{className:"w-4 h-4"})})]}),pe.jsx("button",{onClick:()=>{f([]),w([])},className:"bg-gray-500 hover:bg-gray-600 px-3 py-1 rounded-lg transition-colors",children:"Cancelar"})]})}),pe.jsx("div",{className:"mt-8 bg-red-50 border border-red-200 rounded-lg p-6",children:pe.jsxs("div",{className:"flex items-start",children:[pe.jsx(K,{className:"w-6 h-6 text-red-600 mr-3 mt-1"}),pe.jsxs("div",{children:[pe.jsx("h4",{className:"text-lg font-semibold text-red-800 mb-2",children:"⚠️ Panel de Administrador del Sistema"}),pe.jsxs("ul",{className:"text-red-700 space-y-1 text-sm",children:[pe.jsx("li",{children:"• Este panel es solo para control y mantenimiento del sistema"}),pe.jsx("li",{children:"• Las eliminaciones son permanentes e irreversibles"}),pe.jsx("li",{children:"• Eliminar usuarios también elimina sus propiedades y solicitudes"}),pe.jsx("li",{children:"• Solo elimina contenido que viole términos de servicio o sea spam"})]})]})]})})]})})},De=()=>{const[s,a]=e.useState(null),[l,n]=e.useState([]),[m,x]=e.useState([]),[h,p]=e.useState([]),[g,y]=e.useState(!0),[N,f]=e.useState("overview"),[v,w]=e.useState([]),[C,k]=e.useState(!1),[E,I]=e.useState("");e.useEffect((()=>{const e=localStorage.getItem("user");if(e)try{const s=JSON.parse(e);a(s),console.log("👤 Usuario cargado:",s),D(s)}catch(s){console.error("Error parsing user data:",s),P.error("Error al cargar datos del usuario"),y(!1)}else console.log("❌ No hay datos de usuario en localStorage"),y(!1)}),[]);const D=async e=>{console.log("🔄 Iniciando fetchUserData para:",e.username),y(!0);try{await Promise.all([A(e.username),M(),R()])}catch(s){console.error("Error fetching user data:",s),P.error("Error al cargar datos")}finally{y(!1)}},A=async e=>{try{console.log("🏠 Buscando propiedades de:",e);const s=await fetch("/api/properties",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const a=await s.json();console.log("📋 Todas las propiedades:",a);const t=a.filter((s=>s.ownerUsername===e));console.log("🏡 Propiedades del usuario:",t),n(t),w([])}catch(s){console.error("Error fetching properties:",s),P.error("Error al cargar propiedades")}},M=async()=>{try{console.log("🔑 Obteniendo mis solicitudes...");const e=await fetch("/api/rentals/my-requests",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const s=await e.json();console.log("📝 Mis solicitudes:",s),x(s)}catch(e){console.error("Error fetching rentals:",e),P.error("Error al cargar solicitudes")}},R=async()=>{try{console.log("📥 Obteniendo solicitudes recibidas...");const e=await fetch("/api/rentals/property-requests",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const s=await e.json();console.log("📨 Solicitudes recibidas:",s),p(s)}catch(e){console.error("Error fetching received requests:",e),P.error("Error al cargar solicitudes recibidas")}},T=()=>{w(l.map((e=>e.id)))},q=()=>{w([])},L=async()=>{if(0===v.length)return void P.error("Selecciona al menos una propiedad");const e=parseFloat(E);if(isNaN(e)||e<0||e>50)P.error("El descuento debe estar entre 0% y 50%");else if(window.confirm(`¿Aplicar ${E}% de descuento a ${v.length} propiedades seleccionadas?`))try{console.log("💰 Aplicando descuento del",E,"% a",v.length,"propiedades");const a=1-e/100;let t=0;const r=l.filter((e=>v.includes(e.id)));for(const e of r){const s=parseFloat((e.price*a).toFixed(2));(await fetch(`/api/properties/${e.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({...e,price:s})})).ok?(t++,console.log(`✅ Propiedad ${e.id} actualizada: €${e.price} → €${s}`)):console.error(`❌ Error actualizando propiedad ${e.id}`)}P.success(`Descuento del ${E}% aplicado a ${t} propiedades`),k(!1),I(""),w([]),s&&A(s.username)}catch(a){console.error("Error aplicando descuento:",a),P.error("Error al aplicar descuento")}},F=l.reduce(((e,s)=>e+parseFloat(s.price||0)),0),$=l.length>0?F/l.length:0,z=l.filter((e=>e.available)).length;l.filter((e=>!e.available)).length;const H=h.filter((e=>"PENDING"===e.status)).length,B=h.filter((e=>"APPROVED"===e.status)).length;m.filter((e=>"PENDING"===e.status)).length;const G=m.filter((e=>"APPROVED"===e.status)).length,V=e=>new Date(e).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"}),J=e=>{switch(e){case"APPROVED":return pe.jsx(U,{className:"w-4 h-4 text-green-500"});case"REJECTED":return pe.jsx(W,{className:"w-4 h-4 text-red-500"});case"PENDING":return pe.jsx(_,{className:"w-4 h-4 text-yellow-500"});default:return pe.jsx(_,{className:"w-4 h-4 text-gray-500"})}};return s||g?g?pe.jsx("div",{className:"min-h-screen flex items-center justify-center",children:pe.jsxs("div",{className:"text-center",children:[pe.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-500 mx-auto mb-4"}),pe.jsx("p",{className:"text-gray-600",children:"Cargando datos del dashboard..."})]})}):pe.jsx("div",{className:"min-h-screen pt-20 px-4",children:pe.jsxs("div",{className:"max-w-7xl mx-auto",children:[pe.jsxs(t.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8},className:"text-center mb-12",children:[pe.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-primary-500 to-secondary-500 rounded-2xl flex items-center justify-center mx-auto mb-4",children:pe.jsx(i,{className:"w-8 h-8 text-white"})}),pe.jsx("h1",{className:"text-4xl font-bold text-gray-800 mb-4",children:"Mi Dashboard"}),pe.jsxs("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto",children:["Bienvenido ",(null==s?void 0:s.firstName)||(null==s?void 0:s.username),", gestiona tus propiedades y solicitudes"]})]}),pe.jsx("div",{className:"flex justify-center mb-8",children:pe.jsxs("div",{className:"flex bg-gray-100 rounded-xl p-1",children:[pe.jsxs("button",{onClick:()=>f("overview"),className:"px-6 py-3 rounded-lg transition-all duration-300 "+("overview"===N?"bg-white text-primary-600 shadow-md":"text-gray-600 hover:text-gray-800"),children:[pe.jsx(o,{className:"w-5 h-5 mr-2 inline"}),"Resumen"]}),pe.jsxs("button",{onClick:()=>f("my-properties"),className:"px-6 py-3 rounded-lg transition-all duration-300 "+("my-properties"===N?"bg-white text-primary-600 shadow-md":"text-gray-600 hover:text-gray-800"),children:[pe.jsx(r,{className:"w-5 h-5 mr-2 inline"}),"Mis Propiedades (",l.length,")"]})]})}),pe.jsxs(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},children:["overview"===N&&pe.jsxs("div",{className:"space-y-8",children:[pe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[pe.jsxs(t.div,{whileHover:{y:-5},className:"card p-6 text-center",children:[pe.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-xl flex items-center justify-center mx-auto mb-4",children:pe.jsx(r,{className:"w-8 h-8 text-green-600"})}),pe.jsx("div",{className:"text-3xl font-bold text-gray-800 mb-2",children:l.length}),pe.jsx("div",{className:"text-gray-600",children:"Mis Propiedades"}),pe.jsxs("div",{className:"text-sm text-gray-500 mt-2",children:[z," disponibles"]})]}),pe.jsxs(t.div,{whileHover:{y:-5},className:"card p-6 text-center",children:[pe.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-xl flex items-center justify-center mx-auto mb-4",children:pe.jsx(O,{className:"w-8 h-8 text-blue-600"})}),pe.jsxs("div",{className:"text-3xl font-bold text-gray-800 mb-2",children:["€",F.toFixed(0)]}),pe.jsx("div",{className:"text-gray-600",children:"Ingresos Potenciales"}),pe.jsxs("div",{className:"text-sm text-gray-500 mt-2",children:["€",$.toFixed(0)," promedio"]})]}),pe.jsxs(t.div,{whileHover:{y:-5},className:"card p-6 text-center",children:[pe.jsx("div",{className:"w-16 h-16 bg-purple-100 rounded-xl flex items-center justify-center mx-auto mb-4",children:pe.jsx(c,{className:"w-8 h-8 text-purple-600"})}),pe.jsx("div",{className:"text-3xl font-bold text-gray-800 mb-2",children:H}),pe.jsx("div",{className:"text-gray-600",children:"Solicitudes Pendientes"}),pe.jsxs("div",{className:"text-sm text-gray-500 mt-2",children:[B," aprobadas"]})]}),pe.jsxs(t.div,{whileHover:{y:-5},className:"card p-6 text-center",children:[pe.jsx("div",{className:"w-16 h-16 bg-yellow-100 rounded-xl flex items-center justify-center mx-auto mb-4",children:pe.jsx(o,{className:"w-8 h-8 text-yellow-600"})}),pe.jsx("div",{className:"text-3xl font-bold text-gray-800 mb-2",children:m.length}),pe.jsx("div",{className:"text-gray-600",children:"Mis Solicitudes"}),pe.jsxs("div",{className:"text-sm text-gray-500 mt-2",children:[G," aprobadas"]})]})]}),pe.jsxs("div",{className:"card p-6",children:[pe.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[pe.jsx(se,{className:"w-6 h-6 mr-2"}),"Acciones Rápidas"]}),pe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[pe.jsxs("button",{onClick:()=>window.location.href="/create-property",className:"p-4 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors flex items-center justify-center",children:[pe.jsx(d,{className:"w-5 h-5 mr-2"}),"Agregar Nueva Propiedad"]}),pe.jsxs("button",{onClick:()=>f("my-properties"),className:"p-4 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors flex items-center justify-center",children:[pe.jsx(r,{className:"w-5 h-5 mr-2"}),"Gestionar Mis Propiedades"]}),pe.jsxs("button",{onClick:()=>window.location.href="/rentals",className:"p-4 bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200 transition-colors flex items-center justify-center",children:[pe.jsx(c,{className:"w-5 h-5 mr-2"}),"Ver Solicitudes"]}),pe.jsxs("button",{onClick:()=>window.location.href="/properties",className:"p-4 bg-orange-100 text-orange-700 rounded-lg hover:bg-orange-200 transition-colors flex items-center justify-center",children:[pe.jsx(b,{className:"w-5 h-5 mr-2"}),"Buscar Propiedades para Alquilar"]})]})]}),(m.length>0||h.length>0)&&pe.jsxs("div",{className:"card p-6",children:[pe.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Actividad Reciente"}),pe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[m.slice(0,3).map((e=>pe.jsxs("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg",children:[pe.jsx("div",{className:"flex-shrink-0 mr-3",children:J(e.status)}),pe.jsxs("div",{className:"flex-1",children:[pe.jsxs("p",{className:"text-sm font-medium text-gray-800",children:["Solicitud para ",e.propertyTitle]}),pe.jsx("p",{className:"text-xs text-gray-500",children:V(e.createdAt)})]})]},e.id))),h.slice(0,3).map((e=>pe.jsxs("div",{className:"flex items-center p-3 bg-blue-50 rounded-lg",children:[pe.jsx("div",{className:"flex-shrink-0 mr-3",children:pe.jsx(i,{className:"w-4 h-4 text-blue-500"})}),pe.jsxs("div",{className:"flex-1",children:[pe.jsxs("p",{className:"text-sm font-medium text-gray-800",children:[e.tenantUsername," solicita ",e.propertyTitle]}),pe.jsx("p",{className:"text-xs text-gray-500",children:V(e.createdAt)})]})]},e.id)))]})]})]}),"my-properties"===N&&pe.jsxs("div",{className:"space-y-6",children:[pe.jsxs("div",{className:"flex justify-between items-center",children:[pe.jsxs("h3",{className:"text-2xl font-semibold text-gray-800",children:["Mis Propiedades (",l.length,")"]}),pe.jsxs("button",{onClick:()=>window.location.href="/create-property",className:"btn-primary flex items-center",children:[pe.jsx(d,{className:"w-5 h-5 mr-2"}),"Agregar Propiedad"]})]}),l.length>0&&pe.jsxs("div",{className:"card p-6 bg-yellow-50 border border-yellow-200",children:[pe.jsxs("h4",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[pe.jsx(ae,{className:"w-5 h-5 mr-2"}),"Gestión de Precios en Lote"]}),pe.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-4",children:[pe.jsx("button",{onClick:T,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:"Seleccionar Todas"}),pe.jsx("button",{onClick:q,className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"Limpiar Selección"}),pe.jsxs("button",{onClick:()=>k(!0),className:"px-4 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 transition-colors",disabled:0===v.length,children:["Aplicar Descuento (",v.length,")"]})]}),v.length>0&&pe.jsxs("div",{className:"text-sm text-yellow-700",children:["✓ ",v.length," propiedades seleccionadas"]})]}),0===l.length?pe.jsxs("div",{className:"text-center py-20",children:[pe.jsx("div",{className:"w-24 h-24 bg-gray-200 rounded-full flex items-center justify-center mx-auto mb-6",children:pe.jsx(r,{className:"w-12 h-12 text-gray-400"})}),pe.jsx("h3",{className:"text-2xl font-semibold text-gray-800 mb-2",children:"No tienes propiedades publicadas"}),pe.jsx("p",{className:"text-gray-600 mb-6",children:"Comienza a generar ingresos publicando tu primera propiedad"}),pe.jsx("button",{onClick:()=>window.location.href="/create-property",className:"btn-primary",children:"Publicar Mi Primera Propiedad"})]}):pe.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:l.map((e=>pe.jsxs(t.div,{whileHover:{y:-5},className:"card p-6 cursor-pointer transition-all duration-300 "+(v.includes(e.id)?"ring-2 ring-yellow-500 bg-yellow-50":""),onClick:()=>{return s=e.id,void w((e=>e.includes(s)?e.filter((e=>e!==s)):[...e,s]));var s},children:[pe.jsxs("div",{className:"relative mb-4",children:[e.images&&e.images.length>0?pe.jsx("img",{src:e.images[0],alt:e.title,className:"w-full h-48 object-cover rounded-lg",onError:e=>{e.target.style.display="none",e.target.nextSibling.style.display="flex"}}):null,pe.jsx("div",{className:"w-full h-48 bg-gradient-to-r from-primary-400 to-secondary-400 rounded-lg flex items-center justify-center",style:{display:e.images&&e.images.length>0?"none":"flex"},children:pe.jsx(u,{className:"w-12 h-12 text-white"})}),pe.jsxs("div",{className:"absolute top-3 right-3 flex space-x-2",children:[v.includes(e.id)&&pe.jsx("div",{className:"bg-yellow-500 text-white p-1 rounded-full",children:pe.jsx(Z,{className:"w-4 h-4"})}),pe.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+(e.available?"bg-green-500 text-white":"bg-red-500 text-white"),children:e.available?"Disponible":"Ocupada"})]})]}),pe.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:e.title}),pe.jsxs("div",{className:"flex items-center text-gray-600 text-sm mb-2",children:[pe.jsx(j,{className:"w-4 h-4 mr-1"}),e.city]}),pe.jsxs("div",{className:"text-2xl font-bold text-green-600 mb-4",children:["€",e.price,"/mes"]}),pe.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600 mb-4",children:[pe.jsxs("span",{children:[e.bedrooms," hab"]}),pe.jsxs("span",{children:[e.bathrooms," baños"]})]}),pe.jsxs("div",{className:"flex space-x-2",onClick:e=>e.stopPropagation(),children:[pe.jsxs("button",{onClick:()=>window.location.href=`/properties/${e.id}`,className:"flex-1 px-3 py-2 bg-blue-100 text-blue-600 rounded-lg hover:bg-blue-200 transition-colors flex items-center justify-center",children:[pe.jsx(S,{className:"w-4 h-4 mr-1"}),"Ver"]}),pe.jsx("button",{onClick:()=>(async(e,a)=>{const t=!a,r=t?"disponible":"ocupada";if(window.confirm(`¿Marcar esta propiedad como ${r}?`))try{console.log(`🔄 Cambiando disponibilidad de propiedad ${e} a:`,t);const a=l.find((s=>s.id===e));(await fetch(`/api/properties/${e}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({...a,available:t})})).ok?(P.success(`Propiedad marcada como ${r}`),s&&A(s.username)):P.error("Error al cambiar disponibilidad")}catch(i){console.error("Error toggling availability:",i),P.error("Error al cambiar disponibilidad")}})(e.id,e.available),className:"flex-1 px-3 py-2 rounded-lg transition-colors flex items-center justify-center "+(e.available?"bg-red-100 text-red-600 hover:bg-red-200":"bg-green-100 text-green-600 hover:bg-green-200"),children:e.available?"Marcar Ocupada":"Marcar Disponible"})]})]},e.id)))}),C&&pe.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:pe.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4",children:[pe.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:["Aplicar Descuento a ",v.length," Propiedades"]}),pe.jsxs("div",{className:"mb-4",children:[pe.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Porcentaje de Descuento (0-50%)"}),pe.jsx("input",{type:"number",value:E,onChange:e=>I(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"Ej: 10",min:"0",max:"50"})]}),pe.jsxs("div",{className:"flex space-x-3",children:[pe.jsx("button",{onClick:()=>{k(!1),I("")},className:"flex-1 px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancelar"}),pe.jsx("button",{onClick:L,className:"flex-1 px-4 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 transition-colors",children:"Aplicar Descuento"})]})]})})]})]}),pe.jsxs("div",{className:"mt-8 bg-blue-50 border border-blue-200 rounded-lg p-6",children:[pe.jsx("h4",{className:"text-lg font-semibold text-blue-800 mb-3",children:"💡 Consejos para maximizar tus ingresos"}),pe.jsxs("ul",{className:"text-blue-700 space-y-2 text-sm",children:[pe.jsx("li",{children:"• Usa fotos de alta calidad para atraer más inquilinos"}),pe.jsx("li",{children:"• Ajusta precios según la temporada y demanda"}),pe.jsx("li",{children:"• Responde rápidamente a las solicitudes de alquiler"}),pe.jsx("li",{children:"• Mantén actualizadas las descripciones de tus propiedades"}),pe.jsx("li",{children:"• Ofrece descuentos temporales para llenar vacantes rápido"})]})]})]})}):pe.jsx("div",{className:"min-h-screen flex items-center justify-center",children:pe.jsxs("div",{className:"text-center",children:[pe.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"No hay datos de usuario"}),pe.jsx("p",{className:"text-gray-600 mb-4",children:"No se pudieron cargar los datos del usuario."}),pe.jsx("button",{onClick:()=>window.location.href="/login",className:"btn-primary",children:"Ir a Login"})]})})},Ae=({username:s,isOwnProfile:a=!1})=>{const[l,n]=e.useState(null),[o,d]=e.useState(!0),[m,x]=e.useState(!1),[p,u]=e.useState({});e.useEffect((()=>{b()}),[s]);const b=async()=>{try{const e=a?"/api/users/profile":`/api/users/${s}`,t={"Content-Type":"application/json"};a&&(t.Authorization=`Bearer ${localStorage.getItem("token")}`);const r=await fetch(e,{headers:t});if(r.ok){const e=await r.json();n(e),u(e)}else P.error("Error al cargar el perfil del usuario")}catch(e){P.error("Error al cargar el perfil del usuario")}finally{d(!1)}},N=e=>{u({...p,[e.target.name]:e.target.value})};return o?pe.jsx("div",{className:"min-h-screen flex items-center justify-center",children:pe.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-500"})}):l?pe.jsx("div",{className:"min-h-screen pt-20 px-4",children:pe.jsxs("div",{className:"max-w-4xl mx-auto",children:[pe.jsxs(t.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8},className:"text-center mb-12",children:[pe.jsx("div",{className:"w-24 h-24 bg-gradient-to-r from-primary-500 to-secondary-500 rounded-full flex items-center justify-center mx-auto mb-4",children:pe.jsx(i,{className:"w-12 h-12 text-white"})}),pe.jsx("h1",{className:"text-4xl font-bold text-gray-800 mb-2",children:m?"Editar Perfil":"Perfil de Usuario"}),pe.jsx("p",{className:"text-xl text-gray-600",children:l.firstName&&l.lastName?`${l.firstName} ${l.lastName}`:l.username}),"ADMIN"===l.role&&pe.jsx("span",{className:"inline-block bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm font-medium mt-2",children:"Administrador"})]}),pe.jsxs(t.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},className:"card p-8 mb-8",children:[pe.jsxs("div",{className:"flex items-center justify-between mb-6",children:[pe.jsx("h3",{className:"text-2xl font-semibold text-gray-800",children:"Información Personal"}),a&&pe.jsx("div",{className:"flex space-x-2",children:m?pe.jsxs(pe.Fragment,{children:[pe.jsx("button",{onClick:()=>{x(!1),u({...l})},className:"p-2 bg-gray-100 text-gray-600 rounded-lg hover:bg-gray-200 transition-colors duration-300",children:pe.jsx(h,{className:"w-5 h-5"})}),pe.jsx("button",{onClick:async()=>{try{const e=await fetch("/api/users/profile",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify(p)});if(e.ok){const s=await e.json();n(s),u(s),x(!1),P.success("Perfil actualizado exitosamente")}else P.error("Error al actualizar el perfil")}catch(e){P.error("Error al actualizar el perfil")}},className:"p-2 bg-green-100 text-green-600 rounded-lg hover:bg-green-200 transition-colors duration-300",children:pe.jsx(z,{className:"w-5 h-5"})})]}):pe.jsx("button",{onClick:()=>{x(!0),u({...l})},className:"p-2 bg-primary-100 text-primary-600 rounded-lg hover:bg-primary-200 transition-colors duration-300",children:pe.jsx(H,{className:"w-5 h-5"})})})]}),pe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[pe.jsxs("div",{children:[pe.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre de Usuario"}),pe.jsxs("div",{className:"relative",children:[pe.jsx(i,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),pe.jsx("input",{type:"text",value:l.username,className:"input-field pl-12 bg-gray-50",disabled:!0})]})]}),pe.jsxs("div",{children:[pe.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),pe.jsxs("div",{className:"relative",children:[pe.jsx(g,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),pe.jsx("input",{type:"email",name:"email",value:m?p.email:l.email,onChange:N,className:"input-field pl-12 "+(m?"":"bg-gray-50"),disabled:!m})]})]}),pe.jsxs("div",{children:[pe.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre"}),pe.jsx("input",{type:"text",name:"firstName",value:m?p.firstName||"":l.firstName||"",onChange:N,className:"input-field "+(m?"":"bg-gray-50"),placeholder:"Tu nombre",disabled:!m})]}),pe.jsxs("div",{children:[pe.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Apellidos"}),pe.jsx("input",{type:"text",name:"lastName",value:m?p.lastName||"":l.lastName||"",onChange:N,className:"input-field "+(m?"":"bg-gray-50"),placeholder:"Tus apellidos",disabled:!m})]}),pe.jsxs("div",{children:[pe.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Teléfono"}),pe.jsxs("div",{className:"relative",children:[pe.jsx(y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),pe.jsx("input",{type:"tel",name:"phone",value:m?p.phone||"":l.phone||"",onChange:N,className:"input-field pl-12 "+(m?"":"bg-gray-50"),placeholder:"Tu número de teléfono",disabled:!m})]})]}),pe.jsxs("div",{children:[pe.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fecha de Registro"}),pe.jsxs("div",{className:"relative",children:[pe.jsx(A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),pe.jsx("input",{type:"text",value:new Date(l.createdAt||Date.now()).toLocaleDateString("es-ES"),className:"input-field pl-12 bg-gray-50",disabled:!0})]})]}),pe.jsxs("div",{className:"md:col-span-2",children:[pe.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Biografía"}),pe.jsx("textarea",{name:"bio",value:m?p.bio||"":l.bio||"",onChange:N,rows:3,className:"input-field resize-none "+(m?"":"bg-gray-50"),placeholder:"Cuéntanos algo sobre ti...",disabled:!m})]})]})]}),!a&&pe.jsxs(t.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8,delay:.4},className:"card p-6 mb-8",children:[pe.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Información de Contacto"}),pe.jsxs("div",{className:"space-y-3",children:[l.email&&pe.jsxs("div",{className:"flex items-center space-x-3",children:[pe.jsx(g,{className:"w-5 h-5 text-primary-500"}),pe.jsx("span",{className:"text-gray-700",children:l.email})]}),l.phone&&pe.jsxs("div",{className:"flex items-center space-x-3",children:[pe.jsx(y,{className:"w-5 h-5 text-primary-500"}),pe.jsx("span",{className:"text-gray-700",children:l.phone})]}),!l.email&&!l.phone&&pe.jsx("p",{className:"text-gray-500 text-sm",children:"Este usuario no ha compartido información de contacto pública."})]})]}),a&&pe.jsxs(t.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8,delay:.6},className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[pe.jsxs("div",{className:"card p-6 text-center",children:[pe.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mx-auto mb-3",children:pe.jsx(r,{className:"w-6 h-6 text-blue-600"})}),pe.jsx("div",{className:"text-2xl font-bold text-gray-800 mb-1",children:"0"}),pe.jsx("div",{className:"text-sm text-gray-600",children:"Propiedades Publicadas"})]}),pe.jsxs("div",{className:"card p-6 text-center",children:[pe.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center mx-auto mb-3",children:pe.jsx(c,{className:"w-6 h-6 text-green-600"})}),pe.jsx("div",{className:"text-2xl font-bold text-gray-800 mb-1",children:"0"}),pe.jsx("div",{className:"text-sm text-gray-600",children:"Alquileres Activos"})]}),pe.jsxs("div",{className:"card p-6 text-center",children:[pe.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center mx-auto mb-3",children:pe.jsx(j,{className:"w-6 h-6 text-purple-600"})}),pe.jsx("div",{className:"text-2xl font-bold text-gray-800 mb-1",children:"0"}),pe.jsx("div",{className:"text-sm text-gray-600",children:"Solicitudes Pendientes"})]})]}),l.bio&&!m&&pe.jsxs(t.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8,delay:.8},className:"card p-6",children:[pe.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:["Acerca de ",l.firstName||l.username]}),pe.jsx("p",{className:"text-gray-700 leading-relaxed",children:l.bio})]})]})}):pe.jsx("div",{className:"min-h-screen flex items-center justify-center",children:pe.jsxs("div",{className:"text-center",children:[pe.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Usuario no encontrado"}),pe.jsx("button",{onClick:()=>window.history.back(),className:"btn-primary",children:"Volver"})]})})};function Me(){const[s,a]=e.useState("home"),[t,r]=e.useState(!1),[i,l]=e.useState(null),[n,o]=e.useState(!0);e.useEffect((()=>{const e=localStorage.getItem("token"),s=localStorage.getItem("user");if(e&&s)try{const e=JSON.parse(s);l(e),r(!0)}catch(i){localStorage.removeItem("token"),localStorage.removeItem("user")}const t=window.location.pathname;console.log("Current path:",t),"/login"===t?a("login"):"/register"===t?a("register"):"/properties"===t?a("properties"):t.startsWith("/properties/")?a("property-detail"):"/create-property"===t?a("create-property"):"/rentals"===t?a("rentals"):t.startsWith("/create-rental/")?a("create-rental"):a("/admin"===t?"admin":"/dashboard"===t?"dashboard":"/profile"===t?"profile":"home"),o(!1)}),[]),e.useEffect((()=>{const e=()=>{const e=window.location.pathname;"/login"===e?a("login"):"/register"===e?a("register"):"/properties"===e?a("properties"):e.startsWith("/properties/")?a("property-detail"):"/create-property"===e?a("create-property"):"/rentals"===e?a("rentals"):e.startsWith("/create-rental/")?a("create-rental"):a("/admin"===e?"admin":"/dashboard"===e?"dashboard":"/profile"===e?"profile":"home")};return window.addEventListener("popstate",e),()=>window.removeEventListener("popstate",e)}),[]);return pe.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex flex-col",children:[pe.jsx(ye,{}),pe.jsx("div",{className:"flex-1",children:(()=>{if(n)return pe.jsx("div",{className:"min-h-screen flex items-center justify-center",children:pe.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-500"})});switch(s){case"login":return pe.jsx(Ne,{});case"register":return pe.jsx(fe,{});case"properties":return pe.jsx(we,{});case"property-detail":return pe.jsx(Ce,{});case"create-property":return t?pe.jsx(Se,{}):pe.jsx(Ne,{});case"rentals":return t?pe.jsx(ke,{}):pe.jsx(Ne,{});case"create-rental":return t?pe.jsx(Ee,{}):pe.jsx(Ne,{});case"admin":return t&&"ADMIN"===(null==i?void 0:i.role)?pe.jsx(Ie,{}):pe.jsx(be,{});case"dashboard":return t?pe.jsx(De,{}):pe.jsx(Ne,{});case"profile":return t?pe.jsx(Ae,{username:null==i?void 0:i.username,isOwnProfile:!0}):pe.jsx(Ne,{});default:return pe.jsx(be,{})}})()}),pe.jsx(je,{}),pe.jsx(te,{position:"top-center",toastOptions:{duration:4e3,style:{background:"#ffffff",color:"#374151",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",borderRadius:"16px"}}})]})}const Re=e.createContext(),Oe=({children:s})=>{const[a,t]=e.useState(null),[r,i]=e.useState(!0);e.useEffect((()=>{const e=localStorage.getItem("token"),s=localStorage.getItem("user");if(e&&s)try{const e=JSON.parse(s);t(e)}catch(a){localStorage.removeItem("token"),localStorage.removeItem("user")}i(!1)}),[]);const l={user:a,login:async e=>{try{const s=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(s.ok){const e=await s.json();return localStorage.setItem("token",e.token),localStorage.setItem("user",JSON.stringify(e.user)),t(e.user),{success:!0}}return{success:!1,message:await s.text()||"Error en el login"}}catch(s){return{success:!1,message:"Error en el login"}}},logout:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),t(null),window.location.href="/"},loading:r,isAuthenticated:!!a,isAdmin:"ADMIN"===(null==a?void 0:a.role)};return pe.jsx(Re.Provider,{value:l,children:s})};ue.createRoot(document.getElementById("root")).render(pe.jsx(a.StrictMode,{children:pe.jsx(Oe,{children:pe.jsx(Me,{})})}));
